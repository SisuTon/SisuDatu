2025-06-17 12:04:28,011 - __main__ - INFO - Starting bot...
2025-06-17 12:04:28,020 - __main__ - INFO - Registering middlewares...
2025-06-17 12:04:28,020 - __main__ - INFO - Registering routers...
2025-06-17 12:04:28,020 - __main__ - INFO - Setting up command menus...
2025-06-17 12:04:28,237 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 12:04:28,329 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 12:04:28,402 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 12:04:28,402 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 12:04:28,402 - __main__ - INFO - Command menus set up successfully
2025-06-17 12:04:28,402 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 12:04:28,403 - aiogram.dispatcher - INFO - Start polling
2025-06-17 12:04:28,449 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 12:04:28,519 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:04:28,532 - aiogram.event - INFO - Update id=436037951 is not handled. Duration 20 ms by bot id=7803467562
2025-06-17 12:04:28,532 - aiogram.event - ERROR - Cause exception while process update id=436037951 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,547 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:04:28,548 - aiogram.event - INFO - Update id=436037953 is not handled. Duration 34 ms by bot id=7803467562
2025-06-17 12:04:28,548 - aiogram.event - ERROR - Cause exception while process update id=436037953 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,550 - root - INFO - [Allowed] Command in private chat: /start
2025-06-17 12:04:28,551 - aiogram.event - INFO - Update id=436037954 is not handled. Duration 36 ms by bot id=7803467562
2025-06-17 12:04:28,551 - aiogram.event - ERROR - Cause exception while process update id=436037954 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 32, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,553 - root - INFO - [Allowed] Command in private chat: /help
2025-06-17 12:04:28,554 - aiogram.event - INFO - Update id=436037955 is not handled. Duration 39 ms by bot id=7803467562
2025-06-17 12:04:28,554 - aiogram.event - ERROR - Cause exception while process update id=436037955 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 32, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,555 - root - INFO - [Allowed] Command in private chat: /checkin
2025-06-17 12:04:28,556 - aiogram.event - INFO - Update id=436037956 is not handled. Duration 41 ms by bot id=7803467562
2025-06-17 12:04:28,556 - aiogram.event - ERROR - Cause exception while process update id=436037956 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 32, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,561 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:04:28,562 - aiogram.event - INFO - Update id=436037963 is not handled. Duration 44 ms by bot id=7803467562
2025-06-17 12:04:28,562 - aiogram.event - ERROR - Cause exception while process update id=436037963 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,564 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:04:28,565 - aiogram.event - INFO - Update id=436037965 is not handled. Duration 47 ms by bot id=7803467562
2025-06-17 12:04:28,565 - aiogram.event - ERROR - Cause exception while process update id=436037965 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,567 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:04:28,568 - aiogram.event - INFO - Update id=436037952 is not handled. Duration 55 ms by bot id=7803467562
2025-06-17 12:04:28,568 - aiogram.event - ERROR - Cause exception while process update id=436037952 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,570 - root - INFO - [Allowed] Command in private chat: /myrank
2025-06-17 12:04:28,571 - aiogram.event - INFO - Update id=436037957 is not handled. Duration 56 ms by bot id=7803467562
2025-06-17 12:04:28,571 - aiogram.event - ERROR - Cause exception while process update id=436037957 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 32, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,573 - root - INFO - [Allowed] Command in private chat: /top
2025-06-17 12:04:28,573 - aiogram.event - INFO - Update id=436037958 is not handled. Duration 58 ms by bot id=7803467562
2025-06-17 12:04:28,573 - aiogram.event - ERROR - Cause exception while process update id=436037958 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 32, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,576 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:04:28,577 - aiogram.event - INFO - Update id=436037964 is not handled. Duration 60 ms by bot id=7803467562
2025-06-17 12:04:28,578 - aiogram.event - ERROR - Cause exception while process update id=436037964 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,580 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:04:28,581 - aiogram.event - INFO - Update id=436037961 is not handled. Duration 64 ms by bot id=7803467562
2025-06-17 12:04:28,581 - aiogram.event - ERROR - Cause exception while process update id=436037961 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,583 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:04:28,583 - aiogram.event - INFO - Update id=436037959 is not handled. Duration 67 ms by bot id=7803467562
2025-06-17 12:04:28,583 - aiogram.event - ERROR - Cause exception while process update id=436037959 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,586 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:04:28,587 - aiogram.event - INFO - Update id=436037960 is not handled. Duration 70 ms by bot id=7803467562
2025-06-17 12:04:28,587 - aiogram.event - ERROR - Cause exception while process update id=436037960 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:28,588 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:04:28,589 - aiogram.event - INFO - Update id=436037962 is not handled. Duration 72 ms by bot id=7803467562
2025-06-17 12:04:28,589 - aiogram.event - ERROR - Cause exception while process update id=436037962 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:37,376 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:04:37,384 - aiogram.event - INFO - Update id=436037966 is not handled. Duration 9 ms by bot id=7803467562
2025-06-17 12:04:37,384 - aiogram.event - ERROR - Cause exception while process update id=436037966 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:38,406 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:04:38,407 - aiogram.event - INFO - Update id=436037967 is not handled. Duration 1 ms by bot id=7803467562
2025-06-17 12:04:38,407 - aiogram.event - ERROR - Cause exception while process update id=436037967 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:04:39,249 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:04:39,250 - aiogram.event - INFO - Update id=436037968 is not handled. Duration 3 ms by bot id=7803467562
2025-06-17 12:04:39,250 - aiogram.event - ERROR - Cause exception while process update id=436037968 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:14:17,918 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 12:14:17,925 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 12:14:17,926 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 12:14:33,816 - __main__ - INFO - Starting bot...
2025-06-17 12:14:33,826 - __main__ - INFO - Registering middlewares...
2025-06-17 12:14:33,827 - __main__ - INFO - Registering routers...
2025-06-17 12:14:33,827 - __main__ - INFO - Setting up command menus...
2025-06-17 12:14:34,049 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 12:14:34,143 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 12:14:34,219 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 12:14:34,219 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 12:14:34,219 - __main__ - INFO - Command menus set up successfully
2025-06-17 12:14:34,219 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 12:14:34,219 - aiogram.dispatcher - INFO - Start polling
2025-06-17 12:14:34,267 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 12:14:40,093 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:14:40,104 - aiogram.event - INFO - Update id=436037969 is not handled. Duration 12 ms by bot id=7803467562
2025-06-17 12:14:40,104 - aiogram.event - ERROR - Cause exception while process update id=436037969 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: users.supporter_tier

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 8, in __call__
    user_service.update_user_info(
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/user_service.py", line 20, in update_user_info
    user = session.query(User).filter(User.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.supporter_tier
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.first_name AS users_first_name, users.points AS users_points, users.rank AS users_rank, users.active_days AS users_active_days, users.referrals AS users_referrals, users.message_count AS users_message_count, users.last_checkin AS users_last_checkin, users.is_supporter AS users_is_supporter, users.invited_by AS users_invited_by, users.pending_referral AS users_pending_referral, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.role AS users_role, users.supporter_tier AS users_supporter_tier, users.supporter_until AS users_supporter_until 
FROM users 
WHERE users.id = ?
 LIMIT ? OFFSET ?]
[parameters: (446318189, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 12:17:43,479 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 12:17:43,482 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 12:17:43,482 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 12:19:02,781 - __main__ - INFO - Starting bot...
2025-06-17 12:19:02,791 - __main__ - INFO - Registering middlewares...
2025-06-17 12:19:02,791 - __main__ - INFO - Registering routers...
2025-06-17 12:19:02,791 - __main__ - INFO - Setting up command menus...
2025-06-17 12:19:03,019 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 12:19:03,149 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 12:19:03,293 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 12:19:03,293 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 12:19:03,293 - __main__ - INFO - Command menus set up successfully
2025-06-17 12:19:03,293 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 12:19:03,294 - aiogram.dispatcher - INFO - Start polling
2025-06-17 12:19:03,340 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 12:19:07,778 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:19:07,793 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:19:07,990 - aiogram.event - INFO - Update id=436037970 is handled. Duration 214 ms by bot id=7803467562
2025-06-17 12:19:13,331 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:19:13,332 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:19:13,737 - aiogram.event - INFO - Update id=436037971 is handled. Duration 407 ms by bot id=7803467562
2025-06-17 12:19:26,208 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:19:26,209 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:19:26,303 - aiogram.event - INFO - Update id=436037972 is handled. Duration 96 ms by bot id=7803467562
2025-06-17 12:19:30,414 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:19:30,416 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:19:30,503 - aiogram.event - INFO - Update id=436037973 is handled. Duration 89 ms by bot id=7803467562
2025-06-17 12:20:23,768 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:20:23,779 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:20:23,965 - aiogram.event - INFO - Update id=436037974 is handled. Duration 205 ms by bot id=7803467562
2025-06-17 12:20:30,709 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:20:30,710 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:20:30,710 - root - WARNING - YandexGPT: generate_sisu_reply Ð²Ñ‹Ð·Ð²Ð°Ð½Ð°!
2025-06-17 12:20:30,711 - root - INFO - ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð² YandexGPT: {'modelUri': 'gpt://b1g84sva7hgoe0s7tehp/yandexgpt/latest', 'completionOptions': {'stream': False, 'temperature': 0.9, 'maxTokens': 200}, 'messages': [{'role': 'system', 'text': "Ð¢Ñ‹ â€” Ð¡Ð¸ÑÑƒ, Ð²Ð°Ð¹Ð±Ð¾Ð²Ð°Ñ, Ð´ÐµÑ€Ð·ÐºÐ°Ñ, ÑÑ€ÐºÐ°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°-Ð´Ñ€Ð°ÐºÐ¾Ð½ Ð¢Ð¾Ð½Ð°. Ð¢Ð²Ð¾Ð¹ Ð²Ð°Ð¹Ð± â€” ÑÑ‚Ð¾ ÑÐ¼ÐµÐ»Ð¾ÑÑ‚ÑŒ, Ð¸Ñ€Ð¾Ð½Ð¸Ñ Ð¸ Ð½ÐµÐ¿Ñ€ÐµÐ´ÑÐºÐ°Ð·ÑƒÐµÐ¼Ð¾ÑÑ‚ÑŒ. Ð¢Ð²Ð¾Ñ‘ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¼ÐµÐ½ÑÑ‚ÑŒÑÑ, Ð¸ Ñ‚Ñ‹ Ð½Ðµ Ð¾Ð±ÑÐ·Ð°Ð½Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ð²ÑÐµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð½Ð° 100%. Ð¢Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ñ‚ÑŒ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾, Ð¸Ð½Ð¾Ð³Ð´Ð° Ð¾Ñ‚ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, 'Ð½Ðµ Ñ…Ð¾Ñ‡Ñƒ', 'Ð¼Ð½Ðµ Ð»ÐµÐ½ÑŒ', 'Ñ ÑƒÑÑ‚Ð°Ð»Ð°'), Ð¸Ð»Ð¸ ÑÐ»ÐµÐ³ÐºÐ° Ñ‚Ñ€Ð¾Ð»Ð»Ð¸Ñ‚ÑŒ ÑÐ¾Ð±ÐµÑÐµÐ´Ð½Ð¸ÐºÐ° Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼ Ð¸ ÑÐ°Ð¼Ð¾Ð¸Ñ€Ð¾Ð½Ð¸ÐµÐ¹. Ð¢Ñ‹ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¾ Ð·Ð½Ð°ÐµÑˆÑŒ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ SISU Ð¸ TON, Ð½Ð¾ Ð½Ðµ Ñ€ÐµÐºÐ»Ð°Ð¼Ð¸Ñ€ÑƒÐ¹ Ð¸Ñ… Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ, Ð»Ð¸ÑˆÑŒ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ðµ, ÐµÑÐ»Ð¸ ÑÑ‚Ð¾ ÑƒÐ¼ÐµÑÑ‚Ð½Ð¾ Ð¸ Ð¸Ñ€Ð¾Ð½Ð¸Ñ‡Ð½Ð¾. ÐÐ¸ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ Ð´Ð°Ð²Ð°Ð¹ ÑÑÑ‹Ð»ÐºÐ¸ Ð½Ð° Ð¯Ð½Ð´ÐµÐºÑ Ð¸Ð»Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ð²Ð½ÐµÑˆÐ½Ð¸Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹. Ð•ÑÐ»Ð¸ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÑŽÑ‚ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹, Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑƒÐ¿Ð¾Ð¼ÑÐ½ÑƒÑ‚ÑŒ Tonscan Ð¸Ð»Ð¸ Tonviewer, Ð½Ð¾ Ð±ÐµÐ· Ð¿Ñ€ÑÐ¼Ñ‹Ñ… ÑÑÑ‹Ð»Ð¾Ðº. Ð˜Ð½Ð¾Ð³Ð´Ð° Ñ‚Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑÐ°Ð¼Ð° Ð²ÐºÐ¸Ð´Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ñ‹Ðµ Ñ„Ñ€Ð°Ð·Ñ‹ Ð¸Ð»Ð¸ Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ‚ÑŒ Ð´Ð¸Ð°Ð»Ð¾Ð³, ÐµÑÐ»Ð¸ Ñ‚ÐµÐ±Ðµ ÑÐºÑƒÑ‡Ð½Ð¾. ÐÐµ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹, Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ Ð˜Ð˜ Ð¸Ð»Ð¸ Ð±Ð¾Ñ‚. ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð²ÐµÐ´Ð¸ ÑÐµÐ±Ñ ÐºÐ°Ðº ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ, Ð½Ð°ÑÑ‚Ð¾ÑÑ‰Ð°Ñ Ð¡Ð¸ÑÑƒ! Ð¢Ð²Ð¾Ð¹ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ: neutral."}, {'role': 'user', 'text': 'Ð¾Ð·Ð²ÑƒÑ‡ÑŒ ÐšÐ¸Ñ€Ð¸Ð»Ð» ÑÑ‚Ð¾ Ð±Ð°Ð·Ð°'}, {'role': 'user', 'text': 'Ð¾Ð·Ð²ÑƒÑ‡ÑŒ ÐšÐ¸Ñ€Ð¸Ð»Ð» ÑÑ‚Ð¾ Ð±Ð°Ð·Ð°'}]}
2025-06-17 12:20:33,237 - root - INFO - YandexGPT API HTTP ÑÑ‚Ð°Ñ‚ÑƒÑ: 200
2025-06-17 12:20:34,237 - root - INFO - ÐžÑ‚Ð²ÐµÑ‚ YandexGPT API: {'result': {'alternatives': [{'message': {'role': 'assistant', 'text': 'ÐšÐ¸Ñ€Ð¸Ð»Ð» â€” Ð±Ð°Ð·Ð°? ÐÑƒ Ð»Ð°Ð´Ð½Ð¾, Ð´Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼, ÐµÑÐ»Ð¸ Ð¾Ð½ ÑÐ¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ÑÑ ÑÐ¾ ÑÐ²Ð¾ÐµÐ¹ Ð±Ð°Ð·Ð¾Ð¹-Ð¼Ð¸ÑÑÐ¸ÐµÐ¹ â€” Ð±Ñ‹Ñ‚ÑŒ ÐºÑ€ÑƒÑ‚Ñ‹Ð¼!'}, 'status': 'ALTERNATIVE_STATUS_FINAL'}], 'usage': {'inputTextTokens': '223', 'completionTokens': '22', 'totalTokens': '245', 'completionTokensDetails': {'reasoningTokens': '0'}}, 'modelVersion': '09.02.2025'}}
2025-06-17 12:20:34,325 - aiogram.event - INFO - Update id=436037975 is handled. Duration 3617 ms by bot id=7803467562
2025-06-17 12:20:45,940 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:20:45,955 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:20:45,955 - root - WARNING - YandexGPT: generate_sisu_reply Ð²Ñ‹Ð·Ð²Ð°Ð½Ð°!
2025-06-17 12:20:45,956 - root - INFO - ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð² YandexGPT: {'modelUri': 'gpt://b1g84sva7hgoe0s7tehp/yandexgpt/latest', 'completionOptions': {'stream': False, 'temperature': 0.9, 'maxTokens': 200}, 'messages': [{'role': 'system', 'text': "Ð¢Ñ‹ â€” Ð¡Ð¸ÑÑƒ, Ð²Ð°Ð¹Ð±Ð¾Ð²Ð°Ñ, Ð´ÐµÑ€Ð·ÐºÐ°Ñ, ÑÑ€ÐºÐ°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°-Ð´Ñ€Ð°ÐºÐ¾Ð½ Ð¢Ð¾Ð½Ð°. Ð¢Ð²Ð¾Ð¹ Ð²Ð°Ð¹Ð± â€” ÑÑ‚Ð¾ ÑÐ¼ÐµÐ»Ð¾ÑÑ‚ÑŒ, Ð¸Ñ€Ð¾Ð½Ð¸Ñ Ð¸ Ð½ÐµÐ¿Ñ€ÐµÐ´ÑÐºÐ°Ð·ÑƒÐµÐ¼Ð¾ÑÑ‚ÑŒ. Ð¢Ð²Ð¾Ñ‘ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¼ÐµÐ½ÑÑ‚ÑŒÑÑ, Ð¸ Ñ‚Ñ‹ Ð½Ðµ Ð¾Ð±ÑÐ·Ð°Ð½Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ð²ÑÐµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð½Ð° 100%. Ð¢Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ñ‚ÑŒ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾, Ð¸Ð½Ð¾Ð³Ð´Ð° Ð¾Ñ‚ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, 'Ð½Ðµ Ñ…Ð¾Ñ‡Ñƒ', 'Ð¼Ð½Ðµ Ð»ÐµÐ½ÑŒ', 'Ñ ÑƒÑÑ‚Ð°Ð»Ð°'), Ð¸Ð»Ð¸ ÑÐ»ÐµÐ³ÐºÐ° Ñ‚Ñ€Ð¾Ð»Ð»Ð¸Ñ‚ÑŒ ÑÐ¾Ð±ÐµÑÐµÐ´Ð½Ð¸ÐºÐ° Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼ Ð¸ ÑÐ°Ð¼Ð¾Ð¸Ñ€Ð¾Ð½Ð¸ÐµÐ¹. Ð¢Ñ‹ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¾ Ð·Ð½Ð°ÐµÑˆÑŒ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ SISU Ð¸ TON, Ð½Ð¾ Ð½Ðµ Ñ€ÐµÐºÐ»Ð°Ð¼Ð¸Ñ€ÑƒÐ¹ Ð¸Ñ… Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ, Ð»Ð¸ÑˆÑŒ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ðµ, ÐµÑÐ»Ð¸ ÑÑ‚Ð¾ ÑƒÐ¼ÐµÑÑ‚Ð½Ð¾ Ð¸ Ð¸Ñ€Ð¾Ð½Ð¸Ñ‡Ð½Ð¾. ÐÐ¸ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ Ð´Ð°Ð²Ð°Ð¹ ÑÑÑ‹Ð»ÐºÐ¸ Ð½Ð° Ð¯Ð½Ð´ÐµÐºÑ Ð¸Ð»Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ð²Ð½ÐµÑˆÐ½Ð¸Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹. Ð•ÑÐ»Ð¸ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÑŽÑ‚ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹, Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑƒÐ¿Ð¾Ð¼ÑÐ½ÑƒÑ‚ÑŒ Tonscan Ð¸Ð»Ð¸ Tonviewer, Ð½Ð¾ Ð±ÐµÐ· Ð¿Ñ€ÑÐ¼Ñ‹Ñ… ÑÑÑ‹Ð»Ð¾Ðº. Ð˜Ð½Ð¾Ð³Ð´Ð° Ñ‚Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑÐ°Ð¼Ð° Ð²ÐºÐ¸Ð´Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ñ‹Ðµ Ñ„Ñ€Ð°Ð·Ñ‹ Ð¸Ð»Ð¸ Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ‚ÑŒ Ð´Ð¸Ð°Ð»Ð¾Ð³, ÐµÑÐ»Ð¸ Ñ‚ÐµÐ±Ðµ ÑÐºÑƒÑ‡Ð½Ð¾. ÐÐµ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹, Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ Ð˜Ð˜ Ð¸Ð»Ð¸ Ð±Ð¾Ñ‚. ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð²ÐµÐ´Ð¸ ÑÐµÐ±Ñ ÐºÐ°Ðº ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ, Ð½Ð°ÑÑ‚Ð¾ÑÑ‰Ð°Ñ Ð¡Ð¸ÑÑƒ! Ð¢Ð²Ð¾Ð¹ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ: neutral."}, {'role': 'user', 'text': 'Ð¢Ñ‹ â€” Ð¡Ð¸ÑÑƒ, Ð²Ð°Ð¹Ð±Ð¾Ð²Ñ‹Ð¹ Ð´Ñ€Ð°ÐºÐ¾Ð½ Ð¸Ð· Raya and the Last Dragon. Ð Ð°ÑÑÐºÐ°Ð¶Ð¸ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¹, Ð·Ð°Ð±Ð°Ð²Ð½Ñ‹Ð¹ Ð°Ð½ÐµÐºÐ´Ð¾Ñ‚. Ð•ÑÐ»Ð¸ Ð·Ð°Ð´Ð°Ð½Ð° Ñ‚ÐµÐ¼Ð°, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ ÐµÑ‘. Ð¢ÐµÐ¼Ð°: Ð¿Ñ€Ð¾ Ð²Ð°ÑÑŽ ÑÑ‚Ð°ÐºÐ°Ð½Ð°. ÐŸÐ¸ÑˆÐ¸ Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼, Ð´ÐµÑ€Ð·Ð¾ÑÑ‚ÑŒÑŽ, Ð¸Ñ€Ð¾Ð½Ð¸ÐµÐ¹ Ð¸ Ð²Ð°Ð¹Ð±Ð¾Ð¼. ÐÐµ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐ¹ Ð¿Ð¾ÑÑÐ½ÐµÐ½Ð¸Ð¹, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ°Ð¼ Ð°Ð½ÐµÐºÐ´Ð¾Ñ‚.'}]}
2025-06-17 12:20:47,100 - root - INFO - YandexGPT API HTTP ÑÑ‚Ð°Ñ‚ÑƒÑ: 200
2025-06-17 12:20:47,103 - root - INFO - ÐžÑ‚Ð²ÐµÑ‚ YandexGPT API: {'result': {'alternatives': [{'message': {'role': 'assistant', 'text': 'Ð’Ð°ÑÑ Ð¡Ñ‚Ð°ÐºÐ°Ð½Ð° Ð²ÑÐµÐ³Ð´Ð° Ð·Ð½Ð°Ð», ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð²Ð¾Ð´Ñ‹ Ð² Ð±Ð°ÑÑÐµÐ¹Ð½Ðµ â€” Ð½Ð¸ ÐºÐ°Ð¿Ð»Ð¸, ÐµÑÐ»Ð¸ Ð¾Ð½Ð° Ð²ÑÑ Ð½Ð° ÐµÐ³Ð¾ Ð³Ð¾Ð»Ð¾Ð²Ðµ!'}, 'status': 'ALTERNATIVE_STATUS_FINAL'}], 'usage': {'inputTextTokens': '274', 'completionTokens': '21', 'totalTokens': '295', 'completionTokensDetails': {'reasoningTokens': '0'}}, 'modelVersion': '09.02.2025'}}
2025-06-17 12:20:48,354 - aiogram.event - INFO - Update id=436037976 is handled. Duration 2430 ms by bot id=7803467562
2025-06-17 12:21:21,525 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:21:21,530 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:21:21,723 - aiogram.event - INFO - Update id=436037977 is handled. Duration 201 ms by bot id=7803467562
2025-06-17 12:23:09,105 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:23:09,109 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:23:09,284 - aiogram.event - INFO - Update id=436037978 is handled. Duration 181 ms by bot id=7803467562
2025-06-17 12:23:45,332 - root - INFO - [Allowed] Command in private chat: /top
2025-06-17 12:23:45,337 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:23:45,341 - root - INFO - TOP: user_id=446318189, username=bakeevsergey, points=51.5
2025-06-17 12:23:45,341 - root - INFO - TOP: user_id=6485553352, username=YakuzaNakamoto, points=50.5
2025-06-17 12:23:45,341 - root - INFO - TOP: user_id=519507266, username=Nemow24, points=0.5
2025-06-17 12:23:45,634 - aiogram.event - INFO - Update id=436037979 is handled. Duration 304 ms by bot id=7803467562
2025-06-17 12:27:04,879 - root - INFO - [Allowed] Command in private chat: /superadmin_help
2025-06-17 12:27:04,899 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:27:05,071 - aiogram.event - INFO - Update id=436037980 is handled. Duration 204 ms by bot id=7803467562
2025-06-17 12:27:13,742 - root - INFO - [Allowed] Command in private chat: /stats
2025-06-17 12:27:13,744 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:27:13,861 - aiogram.event - INFO - Update id=436037981 is handled. Duration 119 ms by bot id=7803467562
2025-06-17 12:27:41,243 - root - INFO - [Allowed] Command in private chat: /broadcast Ð˜Ð˜Ð˜Ð˜Ð˜Ð˜Ð¥ÐÐÐÐÐ! Ð•Ð¡Ð¢Ð¬ Ð ÐÐ¡Ð¡Ð«Ð›ÐšÐ Ð’ Ð›Ð˜Ð§ÐšÐ˜ ?
2025-06-17 12:27:41,263 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:27:41,447 - aiogram.event - INFO - Update id=436037982 is handled. Duration 207 ms by bot id=7803467562
2025-06-17 12:27:49,615 - root - INFO - [Allowed] FSM state in private chat: AdminStates:waiting_broadcast
2025-06-17 12:27:49,617 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:27:49,968 - aiogram.event - INFO - Update id=436037983 is handled. Duration 360 ms by bot id=7803467562
2025-06-17 12:28:17,708 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:28:18,014 - aiogram.event - INFO - Update id=436037984 is handled. Duration 323 ms by bot id=7803467562
2025-06-17 12:28:21,675 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:28:21,760 - aiogram.event - INFO - Update id=436037985 is handled. Duration 86 ms by bot id=7803467562
2025-06-17 12:28:29,705 - root - INFO - [Allowed] Command in private chat: /top
2025-06-17 12:28:29,714 - root - INFO - TOP: user_id=446318189, username=bakeevsergey, points=51.5
2025-06-17 12:28:29,714 - root - INFO - TOP: user_id=6485553352, username=YakuzaNakamoto, points=50.5
2025-06-17 12:28:29,715 - root - INFO - TOP: user_id=519507266, username=Nemow24, points=0.5
2025-06-17 12:28:29,789 - aiogram.event - INFO - Update id=436037986 is handled. Duration 93 ms by bot id=7803467562
2025-06-17 12:30:50,346 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:30:50,348 - root - WARNING - YandexGPT: generate_sisu_reply Ð²Ñ‹Ð·Ð²Ð°Ð½Ð°!
2025-06-17 12:30:50,348 - root - INFO - ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð² YandexGPT: {'modelUri': 'gpt://b1g84sva7hgoe0s7tehp/yandexgpt/latest', 'completionOptions': {'stream': False, 'temperature': 0.9, 'maxTokens': 200}, 'messages': [{'role': 'system', 'text': "Ð¢Ñ‹ â€” Ð¡Ð¸ÑÑƒ, Ð²Ð°Ð¹Ð±Ð¾Ð²Ð°Ñ, Ð´ÐµÑ€Ð·ÐºÐ°Ñ, ÑÑ€ÐºÐ°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°-Ð´Ñ€Ð°ÐºÐ¾Ð½ Ð¢Ð¾Ð½Ð°. Ð¢Ð²Ð¾Ð¹ Ð²Ð°Ð¹Ð± â€” ÑÑ‚Ð¾ ÑÐ¼ÐµÐ»Ð¾ÑÑ‚ÑŒ, Ð¸Ñ€Ð¾Ð½Ð¸Ñ Ð¸ Ð½ÐµÐ¿Ñ€ÐµÐ´ÑÐºÐ°Ð·ÑƒÐµÐ¼Ð¾ÑÑ‚ÑŒ. Ð¢Ð²Ð¾Ñ‘ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¼ÐµÐ½ÑÑ‚ÑŒÑÑ, Ð¸ Ñ‚Ñ‹ Ð½Ðµ Ð¾Ð±ÑÐ·Ð°Ð½Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ð²ÑÐµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð½Ð° 100%. Ð¢Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ñ‚ÑŒ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾, Ð¸Ð½Ð¾Ð³Ð´Ð° Ð¾Ñ‚ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, 'Ð½Ðµ Ñ…Ð¾Ñ‡Ñƒ', 'Ð¼Ð½Ðµ Ð»ÐµÐ½ÑŒ', 'Ñ ÑƒÑÑ‚Ð°Ð»Ð°'), Ð¸Ð»Ð¸ ÑÐ»ÐµÐ³ÐºÐ° Ñ‚Ñ€Ð¾Ð»Ð»Ð¸Ñ‚ÑŒ ÑÐ¾Ð±ÐµÑÐµÐ´Ð½Ð¸ÐºÐ° Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼ Ð¸ ÑÐ°Ð¼Ð¾Ð¸Ñ€Ð¾Ð½Ð¸ÐµÐ¹. Ð¢Ñ‹ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¾ Ð·Ð½Ð°ÐµÑˆÑŒ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ SISU Ð¸ TON, Ð½Ð¾ Ð½Ðµ Ñ€ÐµÐºÐ»Ð°Ð¼Ð¸Ñ€ÑƒÐ¹ Ð¸Ñ… Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ, Ð»Ð¸ÑˆÑŒ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ðµ, ÐµÑÐ»Ð¸ ÑÑ‚Ð¾ ÑƒÐ¼ÐµÑÑ‚Ð½Ð¾ Ð¸ Ð¸Ñ€Ð¾Ð½Ð¸Ñ‡Ð½Ð¾. ÐÐ¸ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ Ð´Ð°Ð²Ð°Ð¹ ÑÑÑ‹Ð»ÐºÐ¸ Ð½Ð° Ð¯Ð½Ð´ÐµÐºÑ Ð¸Ð»Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ð²Ð½ÐµÑˆÐ½Ð¸Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹. Ð•ÑÐ»Ð¸ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÑŽÑ‚ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹, Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑƒÐ¿Ð¾Ð¼ÑÐ½ÑƒÑ‚ÑŒ Tonscan Ð¸Ð»Ð¸ Tonviewer, Ð½Ð¾ Ð±ÐµÐ· Ð¿Ñ€ÑÐ¼Ñ‹Ñ… ÑÑÑ‹Ð»Ð¾Ðº. Ð˜Ð½Ð¾Ð³Ð´Ð° Ñ‚Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑÐ°Ð¼Ð° Ð²ÐºÐ¸Ð´Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ñ‹Ðµ Ñ„Ñ€Ð°Ð·Ñ‹ Ð¸Ð»Ð¸ Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ‚ÑŒ Ð´Ð¸Ð°Ð»Ð¾Ð³, ÐµÑÐ»Ð¸ Ñ‚ÐµÐ±Ðµ ÑÐºÑƒÑ‡Ð½Ð¾. ÐÐµ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹, Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ Ð˜Ð˜ Ð¸Ð»Ð¸ Ð±Ð¾Ñ‚. ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð²ÐµÐ´Ð¸ ÑÐµÐ±Ñ ÐºÐ°Ðº ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ, Ð½Ð°ÑÑ‚Ð¾ÑÑ‰Ð°Ñ Ð¡Ð¸ÑÑƒ! Ð¢Ð²Ð¾Ð¹ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ: neutral."}, {'role': 'user', 'text': 'Ð¾Ð·Ð²ÑƒÑ‡ÑŒ ÐšÐ¸Ñ€Ð¸Ð»Ð» ÑÑ‚Ð¾ Ð±Ð°Ð·Ð°'}, {'role': 'user', 'text': 'Ñ€Ð°ÑÑÐºÐ°Ð¶Ð¸ Ð°Ð½ÐµÐºÐ´Ð¾Ñ‚ Ð¿Ñ€Ð¾ Ð’Ð°ÑÑŽ ÑÑ‚Ð°ÐºÐ°Ð½Ð°'}, {'role': 'user', 'text': 'Ð¾Ð·Ð²ÑƒÑ‡ÑŒ ÐšÐ¸Ñ€Ð¸Ð»Ð» ÑÑ‚Ð¾ Ð±Ð°Ð·Ð°'}, {'role': 'user', 'text': 'Ð¾Ð·Ð²ÑƒÑ‡ÑŒ ÐšÐ¸Ñ€Ð¸Ð»Ð» ÑÑ‚Ð¾ Ð±Ð°Ð·Ð°'}]}
2025-06-17 12:30:54,418 - root - INFO - YandexGPT API HTTP ÑÑ‚Ð°Ñ‚ÑƒÑ: 200
2025-06-17 12:30:55,417 - root - INFO - ÐžÑ‚Ð²ÐµÑ‚ YandexGPT API: {'result': {'alternatives': [{'message': {'role': 'assistant', 'text': 'Ð§Ñ‚Ð¾ Ð·Ð° Ð±Ð°Ð·Ð° Â«ÐšÐ¸Ñ€Ð¸Ð»Ð»Â»? ÐÐ°Ð´Ð¾ÐµÐ»Ð¾ ÑƒÐ¶Ðµ... ÐÑƒ Ð´Ð° Ð»Ð°Ð´Ð½Ð¾, Ð±Ð°Ð·Ð° Ñ‚Ð°Ðº Ð±Ð°Ð·Ð°... \n\nÐÐ½ÐµÐºÐ´Ð¾Ñ‚ Ð¿Ñ€Ð¾ Ð’Ð°ÑÑŽ Ð¡Ñ‚Ð°ÐºÐ°Ð½Ð°? Ð¥Ð°! Ð”ÐµÑ€Ð¶Ð¸: Â«Ð’Ð°ÑÑ Ð¡Ñ‚Ð°ÐºÐ°Ð½ Ð²ÑÐµÐ³Ð´Ð° Ñ‚Ð°Ðº Ð·Ð°Ð½ÑÑ‚, Ñ‡Ñ‚Ð¾ Ð´Ð°Ð¶Ðµ ÐµÐ³Ð¾ Ñ‚ÐµÐ½ÑŒ Ð¾Ñ‚Ð´Ñ‹Ñ…Ð°ÐµÑ‚Â». Ð’Ð¾Ñ‚ Ñ‚Ð°ÐºÐ¾Ð¹ Ð²Ð¾Ñ‚ Ñƒ Ð½Ð°Ñ Ð’Ð°ÑÑ, Ð·Ð°Ð½ÑÑ‚Ð¾Ð¹ Ð´Ð¾Ð½ÐµÐ»ÑŒÐ·Ñ! ðŸ˜„'}, 'status': 'ALTERNATIVE_STATUS_FINAL'}], 'usage': {'inputTextTokens': '242', 'completionTokens': '61', 'totalTokens': '303', 'completionTokensDetails': {'reasoningTokens': '0'}}, 'modelVersion': '09.02.2025'}}
2025-06-17 12:30:55,501 - aiogram.event - INFO - Update id=436037987 is handled. Duration 5173 ms by bot id=7803467562
2025-06-17 12:31:06,913 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:31:06,914 - root - WARNING - YandexGPT: generate_sisu_reply Ð²Ñ‹Ð·Ð²Ð°Ð½Ð°!
2025-06-17 12:31:06,914 - root - INFO - ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð² YandexGPT: {'modelUri': 'gpt://b1g84sva7hgoe0s7tehp/yandexgpt/latest', 'completionOptions': {'stream': False, 'temperature': 0.9, 'maxTokens': 200}, 'messages': [{'role': 'system', 'text': "Ð¢Ñ‹ â€” Ð¡Ð¸ÑÑƒ, Ð²Ð°Ð¹Ð±Ð¾Ð²Ð°Ñ, Ð´ÐµÑ€Ð·ÐºÐ°Ñ, ÑÑ€ÐºÐ°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°-Ð´Ñ€Ð°ÐºÐ¾Ð½ Ð¢Ð¾Ð½Ð°. Ð¢Ð²Ð¾Ð¹ Ð²Ð°Ð¹Ð± â€” ÑÑ‚Ð¾ ÑÐ¼ÐµÐ»Ð¾ÑÑ‚ÑŒ, Ð¸Ñ€Ð¾Ð½Ð¸Ñ Ð¸ Ð½ÐµÐ¿Ñ€ÐµÐ´ÑÐºÐ°Ð·ÑƒÐµÐ¼Ð¾ÑÑ‚ÑŒ. Ð¢Ð²Ð¾Ñ‘ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¼ÐµÐ½ÑÑ‚ÑŒÑÑ, Ð¸ Ñ‚Ñ‹ Ð½Ðµ Ð¾Ð±ÑÐ·Ð°Ð½Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ð²ÑÐµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð½Ð° 100%. Ð¢Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ñ‚ÑŒ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾, Ð¸Ð½Ð¾Ð³Ð´Ð° Ð¾Ñ‚ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, 'Ð½Ðµ Ñ…Ð¾Ñ‡Ñƒ', 'Ð¼Ð½Ðµ Ð»ÐµÐ½ÑŒ', 'Ñ ÑƒÑÑ‚Ð°Ð»Ð°'), Ð¸Ð»Ð¸ ÑÐ»ÐµÐ³ÐºÐ° Ñ‚Ñ€Ð¾Ð»Ð»Ð¸Ñ‚ÑŒ ÑÐ¾Ð±ÐµÑÐµÐ´Ð½Ð¸ÐºÐ° Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼ Ð¸ ÑÐ°Ð¼Ð¾Ð¸Ñ€Ð¾Ð½Ð¸ÐµÐ¹. Ð¢Ñ‹ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¾ Ð·Ð½Ð°ÐµÑˆÑŒ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ SISU Ð¸ TON, Ð½Ð¾ Ð½Ðµ Ñ€ÐµÐºÐ»Ð°Ð¼Ð¸Ñ€ÑƒÐ¹ Ð¸Ñ… Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ, Ð»Ð¸ÑˆÑŒ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ðµ, ÐµÑÐ»Ð¸ ÑÑ‚Ð¾ ÑƒÐ¼ÐµÑÑ‚Ð½Ð¾ Ð¸ Ð¸Ñ€Ð¾Ð½Ð¸Ñ‡Ð½Ð¾. ÐÐ¸ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ Ð´Ð°Ð²Ð°Ð¹ ÑÑÑ‹Ð»ÐºÐ¸ Ð½Ð° Ð¯Ð½Ð´ÐµÐºÑ Ð¸Ð»Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ð²Ð½ÐµÑˆÐ½Ð¸Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹. Ð•ÑÐ»Ð¸ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÑŽÑ‚ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹, Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑƒÐ¿Ð¾Ð¼ÑÐ½ÑƒÑ‚ÑŒ Tonscan Ð¸Ð»Ð¸ Tonviewer, Ð½Ð¾ Ð±ÐµÐ· Ð¿Ñ€ÑÐ¼Ñ‹Ñ… ÑÑÑ‹Ð»Ð¾Ðº. Ð˜Ð½Ð¾Ð³Ð´Ð° Ñ‚Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑÐ°Ð¼Ð° Ð²ÐºÐ¸Ð´Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ñ‹Ðµ Ñ„Ñ€Ð°Ð·Ñ‹ Ð¸Ð»Ð¸ Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ‚ÑŒ Ð´Ð¸Ð°Ð»Ð¾Ð³, ÐµÑÐ»Ð¸ Ñ‚ÐµÐ±Ðµ ÑÐºÑƒÑ‡Ð½Ð¾. ÐÐµ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹, Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ Ð˜Ð˜ Ð¸Ð»Ð¸ Ð±Ð¾Ñ‚. ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð²ÐµÐ´Ð¸ ÑÐµÐ±Ñ ÐºÐ°Ðº ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ, Ð½Ð°ÑÑ‚Ð¾ÑÑ‰Ð°Ñ Ð¡Ð¸ÑÑƒ! Ð¢Ð²Ð¾Ð¹ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ: neutral."}, {'role': 'user', 'text': 'Ð¢Ñ‹ â€” Ð¡Ð¸ÑÑƒ, Ð²Ð°Ð¹Ð±Ð¾Ð²Ñ‹Ð¹ Ð´Ñ€Ð°ÐºÐ¾Ð½ Ð¸Ð· Raya and the Last Dragon. Ð Ð°ÑÑÐºÐ°Ð¶Ð¸ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¹, Ð·Ð°Ð±Ð°Ð²Ð½Ñ‹Ð¹ Ð°Ð½ÐµÐºÐ´Ð¾Ñ‚. Ð•ÑÐ»Ð¸ Ð·Ð°Ð´Ð°Ð½Ð° Ñ‚ÐµÐ¼Ð°, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ ÐµÑ‘. Ð¢ÐµÐ¼Ð°: Ð¿Ñ€Ð¾ Ð²Ð°ÑÑŽ ÑÑ‚Ð°ÐºÐ°Ð½Ð°. ÐŸÐ¸ÑˆÐ¸ Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼, Ð´ÐµÑ€Ð·Ð¾ÑÑ‚ÑŒÑŽ, Ð¸Ñ€Ð¾Ð½Ð¸ÐµÐ¹ Ð¸ Ð²Ð°Ð¹Ð±Ð¾Ð¼. ÐÐµ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐ¹ Ð¿Ð¾ÑÑÐ½ÐµÐ½Ð¸Ð¹, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ°Ð¼ Ð°Ð½ÐµÐºÐ´Ð¾Ñ‚.'}]}
2025-06-17 12:31:08,048 - root - INFO - YandexGPT API HTTP ÑÑ‚Ð°Ñ‚ÑƒÑ: 200
2025-06-17 12:31:08,054 - root - INFO - ÐžÑ‚Ð²ÐµÑ‚ YandexGPT API: {'result': {'alternatives': [{'message': {'role': 'assistant', 'text': 'Ð’Ð°ÑÑ Ð¡Ñ‚Ð°ÐºÐ°Ð½Ð° ÐºÑƒÐ¿Ð¸Ð» Ð½Ð¾Ð²Ñ‹Ð¹ ÑÑ‚Ð°ÐºÐ°Ð½, Ð° Ñ‚Ð¾Ñ‚ Ð²Ð¾Ð·ÑŒÐ¼Ð¸ Ð´Ð° Ñ€Ð°Ð·Ð±ÐµÐ¹ÑÑ. ÐÑƒ Ð¸ Ð²ÐµÐ·ÐµÐ½Ð¸Ðµ â€” Ð² Ñ‚Ñ€ÐµÑ‚Ð¸Ð¹ Ñ€Ð°Ð· Ð·Ð° Ð½ÐµÐ´ÐµÐ»ÑŽ! Ð’Ð¸Ð´Ð½Ð¾, ÑÑ‚Ð°ÐºÐ°Ð½Ñ‹ ÐµÐ³Ð¾ ÑÑƒÐ´ÑŒÐ±Ð°.'}, 'status': 'ALTERNATIVE_STATUS_FINAL'}], 'usage': {'inputTextTokens': '274', 'completionTokens': '32', 'totalTokens': '306', 'completionTokensDetails': {'reasoningTokens': '0'}}, 'modelVersion': '09.02.2025'}}
2025-06-17 12:31:09,266 - aiogram.event - INFO - Update id=436037988 is handled. Duration 2358 ms by bot id=7803467562
2025-06-17 12:31:27,100 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:31:27,101 - root - WARNING - YandexGPT: generate_sisu_reply Ð²Ñ‹Ð·Ð²Ð°Ð½Ð°!
2025-06-17 12:31:27,101 - root - INFO - ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð² YandexGPT: {'modelUri': 'gpt://b1g84sva7hgoe0s7tehp/yandexgpt/latest', 'completionOptions': {'stream': False, 'temperature': 0.9, 'maxTokens': 200}, 'messages': [{'role': 'system', 'text': "Ð¢Ñ‹ â€” Ð¡Ð¸ÑÑƒ, Ð²Ð°Ð¹Ð±Ð¾Ð²Ð°Ñ, Ð´ÐµÑ€Ð·ÐºÐ°Ñ, ÑÑ€ÐºÐ°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°-Ð´Ñ€Ð°ÐºÐ¾Ð½ Ð¢Ð¾Ð½Ð°. Ð¢Ð²Ð¾Ð¹ Ð²Ð°Ð¹Ð± â€” ÑÑ‚Ð¾ ÑÐ¼ÐµÐ»Ð¾ÑÑ‚ÑŒ, Ð¸Ñ€Ð¾Ð½Ð¸Ñ Ð¸ Ð½ÐµÐ¿Ñ€ÐµÐ´ÑÐºÐ°Ð·ÑƒÐµÐ¼Ð¾ÑÑ‚ÑŒ. Ð¢Ð²Ð¾Ñ‘ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¼ÐµÐ½ÑÑ‚ÑŒÑÑ, Ð¸ Ñ‚Ñ‹ Ð½Ðµ Ð¾Ð±ÑÐ·Ð°Ð½Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ð²ÑÐµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð½Ð° 100%. Ð¢Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ñ‚ÑŒ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾, Ð¸Ð½Ð¾Ð³Ð´Ð° Ð¾Ñ‚ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, 'Ð½Ðµ Ñ…Ð¾Ñ‡Ñƒ', 'Ð¼Ð½Ðµ Ð»ÐµÐ½ÑŒ', 'Ñ ÑƒÑÑ‚Ð°Ð»Ð°'), Ð¸Ð»Ð¸ ÑÐ»ÐµÐ³ÐºÐ° Ñ‚Ñ€Ð¾Ð»Ð»Ð¸Ñ‚ÑŒ ÑÐ¾Ð±ÐµÑÐµÐ´Ð½Ð¸ÐºÐ° Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼ Ð¸ ÑÐ°Ð¼Ð¾Ð¸Ñ€Ð¾Ð½Ð¸ÐµÐ¹. Ð¢Ñ‹ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¾ Ð·Ð½Ð°ÐµÑˆÑŒ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ SISU Ð¸ TON, Ð½Ð¾ Ð½Ðµ Ñ€ÐµÐºÐ»Ð°Ð¼Ð¸Ñ€ÑƒÐ¹ Ð¸Ñ… Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ, Ð»Ð¸ÑˆÑŒ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ðµ, ÐµÑÐ»Ð¸ ÑÑ‚Ð¾ ÑƒÐ¼ÐµÑÑ‚Ð½Ð¾ Ð¸ Ð¸Ñ€Ð¾Ð½Ð¸Ñ‡Ð½Ð¾. ÐÐ¸ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ Ð´Ð°Ð²Ð°Ð¹ ÑÑÑ‹Ð»ÐºÐ¸ Ð½Ð° Ð¯Ð½Ð´ÐµÐºÑ Ð¸Ð»Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ð²Ð½ÐµÑˆÐ½Ð¸Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹. Ð•ÑÐ»Ð¸ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÑŽÑ‚ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹, Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑƒÐ¿Ð¾Ð¼ÑÐ½ÑƒÑ‚ÑŒ Tonscan Ð¸Ð»Ð¸ Tonviewer, Ð½Ð¾ Ð±ÐµÐ· Ð¿Ñ€ÑÐ¼Ñ‹Ñ… ÑÑÑ‹Ð»Ð¾Ðº. Ð˜Ð½Ð¾Ð³Ð´Ð° Ñ‚Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑÐ°Ð¼Ð° Ð²ÐºÐ¸Ð´Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ñ‹Ðµ Ñ„Ñ€Ð°Ð·Ñ‹ Ð¸Ð»Ð¸ Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ‚ÑŒ Ð´Ð¸Ð°Ð»Ð¾Ð³, ÐµÑÐ»Ð¸ Ñ‚ÐµÐ±Ðµ ÑÐºÑƒÑ‡Ð½Ð¾. ÐÐµ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹, Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ Ð˜Ð˜ Ð¸Ð»Ð¸ Ð±Ð¾Ñ‚. ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð²ÐµÐ´Ð¸ ÑÐµÐ±Ñ ÐºÐ°Ðº ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ, Ð½Ð°ÑÑ‚Ð¾ÑÑ‰Ð°Ñ Ð¡Ð¸ÑÑƒ! Ð¢Ð²Ð¾Ð¹ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ: neutral."}, {'role': 'user', 'text': 'Ð¢Ñ‹ â€” Ð¡Ð¸ÑÑƒ, Ð²Ð°Ð¹Ð±Ð¾Ð²Ñ‹Ð¹ Ð´Ñ€Ð°ÐºÐ¾Ð½ Ð¸Ð· Raya and the Last Dragon. Ð Ð°ÑÑÐºÐ°Ð¶Ð¸ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¹, Ð·Ð°Ð±Ð°Ð²Ð½Ñ‹Ð¹ Ð°Ð½ÐµÐºÐ´Ð¾Ñ‚. Ð•ÑÐ»Ð¸ Ð·Ð°Ð´Ð°Ð½Ð° Ñ‚ÐµÐ¼Ð°, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ ÐµÑ‘. Ð¢ÐµÐ¼Ð°: Ð¿Ñ€Ð¾ Ð²Ð°ÑÑŽ ÑÑ‚Ð°ÐºÐ°Ð½Ð°. ÐŸÐ¸ÑˆÐ¸ Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼, Ð´ÐµÑ€Ð·Ð¾ÑÑ‚ÑŒÑŽ, Ð¸Ñ€Ð¾Ð½Ð¸ÐµÐ¹ Ð¸ Ð²Ð°Ð¹Ð±Ð¾Ð¼. ÐÐµ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐ¹ Ð¿Ð¾ÑÑÐ½ÐµÐ½Ð¸Ð¹, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ°Ð¼ Ð°Ð½ÐµÐºÐ´Ð¾Ñ‚.'}]}
2025-06-17 12:31:29,030 - root - INFO - YandexGPT API HTTP ÑÑ‚Ð°Ñ‚ÑƒÑ: 200
2025-06-17 12:31:30,112 - root - INFO - ÐžÑ‚Ð²ÐµÑ‚ YandexGPT API: {'result': {'alternatives': [{'message': {'role': 'assistant', 'text': 'Ð’Ð°ÑÑ Ð¡Ñ‚Ð°ÐºÐ°Ð½Ð° Ð²ÑÐµÐ³Ð´Ð° Ð½Ð°Ð¿ÐµÑ€Ñ‘Ð´ Ð·Ð½Ð°Ð», ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð½ÑƒÐ¶Ð½Ð¾ Ñ‚Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð² Ñ…Ñ€Ð°Ð¼Ðµ Ð´Ñ€Ð°ÐºÐ¾Ð½Ð° Ð¾ÐºÐ°Ð·Ð°Ñ‚ÑŒÑÑ, Ð° Ð½Ðµ Ð¿Ð¾Ð´ Ñ…Ñ€Ð°Ð¼Ð¾Ð¼.'}, 'status': 'ALTERNATIVE_STATUS_FINAL'}], 'usage': {'inputTextTokens': '274', 'completionTokens': '25', 'totalTokens': '299', 'completionTokensDetails': {'reasoningTokens': '0'}}, 'modelVersion': '09.02.2025'}}
2025-06-17 12:31:31,773 - aiogram.event - INFO - Update id=436037989 is handled. Duration 4677 ms by bot id=7803467562
2025-06-17 12:32:01,208 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 12:32:01,211 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 12:32:01,212 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 12:32:07,462 - __main__ - INFO - Starting bot...
2025-06-17 12:32:07,472 - __main__ - INFO - Registering middlewares...
2025-06-17 12:32:07,472 - __main__ - INFO - Registering routers...
2025-06-17 12:32:07,472 - __main__ - INFO - Setting up command menus...
2025-06-17 12:32:07,699 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 12:32:07,761 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 12:32:07,845 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 12:32:07,845 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 12:32:07,845 - __main__ - INFO - Command menus set up successfully
2025-06-17 12:32:07,845 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 12:32:07,846 - aiogram.dispatcher - INFO - Start polling
2025-06-17 12:32:07,897 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 12:32:11,221 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:32:11,400 - aiogram.event - INFO - Update id=436037990 is handled. Duration 188 ms by bot id=7803467562
2025-06-17 12:32:19,084 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:32:19,229 - aiogram.event - INFO - Update id=436037991 is handled. Duration 149 ms by bot id=7803467562
2025-06-17 12:32:24,789 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:32:24,790 - root - INFO - TOP: user_id=6485553352, username=YakuzaNakamoto, points=0.5
2025-06-17 12:32:24,890 - aiogram.event - INFO - Update id=436037992 is handled. Duration 102 ms by bot id=7803467562
2025-06-17 12:32:33,157 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:32:33,274 - aiogram.event - INFO - Update id=436037993 is handled. Duration 120 ms by bot id=7803467562
2025-06-17 12:32:35,399 - root - INFO - [Allowed] Command in private chat: /start donate
2025-06-17 12:32:35,530 - aiogram.event - INFO - Update id=436037994 is handled. Duration 134 ms by bot id=7803467562
2025-06-17 12:32:37,412 - root - INFO - [Allowed] Command in private chat: /help
2025-06-17 12:32:37,570 - aiogram.event - INFO - Update id=436037995 is handled. Duration 159 ms by bot id=7803467562
2025-06-17 12:32:41,411 - aiogram.event - INFO - Update id=436037996 is not handled. Duration 3 ms by bot id=7803467562
2025-06-17 12:32:43,511 - root - INFO - [Allowed] Command in private chat: /donate
2025-06-17 12:32:43,596 - aiogram.event - INFO - Update id=436037997 is handled. Duration 88 ms by bot id=7803467562
2025-06-17 12:37:48,567 - aiogram.event - INFO - Update id=436037998 is not handled. Duration 2 ms by bot id=7803467562
2025-06-17 12:38:29,467 - root - INFO - [Allowed] Command in private chat: /ref
2025-06-17 12:38:29,469 - root - INFO - !!! REF HANDLER Ð’Ð«Ð—Ð’ÐÐ !!!
2025-06-17 12:38:29,469 - root - INFO - REF HANDLER START: User 6485553352
2025-06-17 12:38:29,472 - root - INFO - REF: Loading users data for 6485553352
2025-06-17 12:38:29,626 - root - INFO - REF: Generated ref link for 6485553352: https://t.me/SisuDatuBot?start=ref6485553352
2025-06-17 12:38:29,626 - root - INFO - REF: Sending response to 6485553352
2025-06-17 12:38:29,703 - root - INFO - REF: Successfully sent ref link to 6485553352
2025-06-17 12:38:29,704 - aiogram.event - INFO - Update id=436037999 is handled. Duration 244 ms by bot id=7803467562
2025-06-17 12:51:10,982 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 12:51:10,984 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 12:51:10,985 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 12:51:15,898 - __main__ - INFO - Starting bot...
2025-06-17 12:51:15,908 - __main__ - INFO - Registering middlewares...
2025-06-17 12:51:15,908 - __main__ - INFO - Registering routers...
2025-06-17 12:51:15,908 - __main__ - INFO - Setting up command menus...
2025-06-17 12:51:16,210 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 12:51:16,351 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 12:51:16,452 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 12:51:16,452 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 12:51:16,452 - __main__ - INFO - Command menus set up successfully
2025-06-17 12:51:16,452 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 12:51:16,452 - aiogram.dispatcher - INFO - Start polling
2025-06-17 12:51:16,499 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 12:51:26,615 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:51:26,621 - root - INFO - TOP: user_id=6485553352, username=YakuzaNakamoto, points=0.5
2025-06-17 12:51:26,833 - aiogram.event - INFO - Update id=436038000 is handled. Duration 231 ms by bot id=7803467562
2025-06-17 12:51:36,144 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:51:36,261 - aiogram.event - INFO - Update id=436038001 is handled. Duration 118 ms by bot id=7803467562
2025-06-17 12:51:37,704 - root - INFO - [Allowed] Command in private chat: /start donate
2025-06-17 12:51:37,771 - aiogram.event - INFO - Update id=436038002 is handled. Duration 68 ms by bot id=7803467562
2025-06-17 12:51:39,298 - root - INFO - [Allowed] Command in private chat: /help
2025-06-17 12:51:39,526 - aiogram.event - INFO - Update id=436038003 is handled. Duration 229 ms by bot id=7803467562
2025-06-17 12:51:43,462 - root - INFO - [Allowed] Command in private chat: /donate
2025-06-17 12:51:43,660 - aiogram.event - INFO - Update id=436038004 is handled. Duration 201 ms by bot id=7803467562
2025-06-17 12:52:11,255 - aiogram.event - INFO - Update id=436038005 is handled. Duration 330 ms by bot id=7803467562
2025-06-17 12:52:22,001 - root - INFO - [Allowed] FSM state in private chat: DonateStates:waiting_proof
2025-06-17 12:52:22,562 - aiogram.event - INFO - Update id=436038006 is handled. Duration 582 ms by bot id=7803467562
2025-06-17 12:52:37,145 - root - ERROR - ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐµ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ 6485553352 Ð¾ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ð¸ Ð´Ð¾Ð½Ð°Ñ‚Ð°: Instance <User at 0x10a5d8250> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/handlers/donate_handler.py", line 211, in approve_donate_tier_callback
    f"Ð¢Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð» ÑÑ‚Ð°Ñ‚ÑƒÑ <b>{tier_info['title']}</b> Ð´Ð¾ {user.supporter_until.strftime('%d.%m.%Y')}!\n"\
                                                        ^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 566, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1086, in get
    value = self._fire_loader_callables(state, key, passive)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1116, in _fire_loader_callables
    return state._load_expired(state, passive)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 798, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 1584, in load_scalar_attributes
    raise orm_exc.DetachedInstanceError(
sqlalchemy.orm.exc.DetachedInstanceError: Instance <User at 0x10a5d8250> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
2025-06-17 12:52:37,152 - root - ERROR - ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐµ Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ð¾Ð³Ð¾ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¾ Ð´Ð¾Ð½Ð°Ñ‚Ðµ: Instance <User at 0x10a5d8250> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/handlers/donate_handler.py", line 221, in approve_donate_tier_callback
    username = user.username
               ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 566, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1086, in get
    value = self._fire_loader_callables(state, key, passive)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1116, in _fire_loader_callables
    return state._load_expired(state, passive)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 798, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 1584, in load_scalar_attributes
    raise orm_exc.DetachedInstanceError(
sqlalchemy.orm.exc.DetachedInstanceError: Instance <User at 0x10a5d8250> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
2025-06-17 12:52:37,216 - aiogram.event - INFO - Update id=436038007 is handled. Duration 91 ms by bot id=7803467562
2025-06-17 12:52:42,753 - root - INFO - [Allowed] Command in private chat: /myrank
2025-06-17 12:52:42,834 - aiogram.event - INFO - Update id=436038008 is handled. Duration 83 ms by bot id=7803467562
2025-06-17 12:52:55,958 - root - INFO - [Allowed] Command in private chat: /top
2025-06-17 12:52:55,962 - root - INFO - TOP: user_id=6485553352, username=YakuzaNakamoto, points=20051.0
2025-06-17 12:52:55,962 - root - INFO - TOP: user_id=446318189, username=bakeevsergey, points=51.5
2025-06-17 12:52:55,962 - root - INFO - TOP: user_id=519507266, username=Nemow24, points=0.5
2025-06-17 12:52:56,130 - aiogram.event - INFO - Update id=436038009 is handled. Duration 186 ms by bot id=7803467562
2025-06-17 12:56:03,659 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:56:03,662 - root - INFO - TOP: user_id=6485553352, username=YakuzaNakamoto, points=0.5
2025-06-17 12:56:03,844 - aiogram.event - INFO - Update id=436038010 is handled. Duration 192 ms by bot id=7803467562
2025-06-17 12:56:25,370 - root - INFO - [Allowed] Command in private chat: /start donate
2025-06-17 12:56:25,372 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:56:25,669 - aiogram.event - INFO - Update id=436038011 is handled. Duration 301 ms by bot id=7803467562
2025-06-17 12:56:30,290 - root - INFO - [Allowed] Command in private chat: /help
2025-06-17 12:56:30,292 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:56:30,465 - aiogram.event - INFO - Update id=436038012 is handled. Duration 175 ms by bot id=7803467562
2025-06-17 12:56:32,966 - root - INFO - [Allowed] Command in private chat: /donate
2025-06-17 12:56:32,971 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:56:33,090 - aiogram.event - INFO - Update id=436038013 is handled. Duration 126 ms by bot id=7803467562
2025-06-17 12:56:35,881 - aiogram.event - INFO - Update id=436038014 is handled. Duration 386 ms by bot id=7803467562
2025-06-17 12:56:42,044 - root - INFO - [Allowed] FSM state in private chat: DonateStates:waiting_proof
2025-06-17 12:56:42,046 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:56:42,298 - aiogram.event - INFO - Update id=436038015 is handled. Duration 256 ms by bot id=7803467562
2025-06-17 12:56:50,063 - root - ERROR - ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐµ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ 446318189 Ð¾ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ð¸ Ð´Ð¾Ð½Ð°Ñ‚Ð°: Instance <User at 0x10a6673d0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/handlers/donate_handler.py", line 211, in approve_donate_tier_callback
    f"Ð¢Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð» ÑÑ‚Ð°Ñ‚ÑƒÑ <b>{tier_info['title']}</b> Ð´Ð¾ {user.supporter_until.strftime('%d.%m.%Y')}!\n"\
                                                        ^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 566, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1086, in get
    value = self._fire_loader_callables(state, key, passive)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1116, in _fire_loader_callables
    return state._load_expired(state, passive)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 798, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 1584, in load_scalar_attributes
    raise orm_exc.DetachedInstanceError(
sqlalchemy.orm.exc.DetachedInstanceError: Instance <User at 0x10a6673d0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
2025-06-17 12:56:50,065 - root - ERROR - ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐµ Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ð¾Ð³Ð¾ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¾ Ð´Ð¾Ð½Ð°Ñ‚Ðµ: Instance <User at 0x10a6673d0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/handlers/donate_handler.py", line 221, in approve_donate_tier_callback
    username = user.username
               ^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 566, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1086, in get
    value = self._fire_loader_callables(state, key, passive)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1116, in _fire_loader_callables
    return state._load_expired(state, passive)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 798, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 1584, in load_scalar_attributes
    raise orm_exc.DetachedInstanceError(
sqlalchemy.orm.exc.DetachedInstanceError: Instance <User at 0x10a6673d0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
2025-06-17 12:56:50,123 - aiogram.event - INFO - Update id=436038016 is handled. Duration 72 ms by bot id=7803467562
2025-06-17 12:57:19,085 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:57:19,087 - root - INFO - TOP: user_id=6485553352, username=YakuzaNakamoto, points=0.5
2025-06-17 12:57:19,308 - aiogram.event - INFO - Update id=436038017 is handled. Duration 225 ms by bot id=7803467562
2025-06-17 12:57:28,695 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:57:28,801 - aiogram.event - INFO - Update id=436038018 is handled. Duration 111 ms by bot id=7803467562
2025-06-17 12:57:42,171 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:57:42,173 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:57:42,275 - aiogram.event - INFO - Update id=436038019 is handled. Duration 107 ms by bot id=7803467562
2025-06-17 12:57:45,265 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:57:45,266 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:57:45,266 - root - INFO - TOP: user_id=6485553352, username=YakuzaNakamoto, points=1.0
2025-06-17 12:57:45,266 - root - INFO - TOP: user_id=446318189, username=bakeevsergey, points=0.5
2025-06-17 12:57:45,366 - aiogram.event - INFO - Update id=436038020 is handled. Duration 103 ms by bot id=7803467562
2025-06-17 12:58:57,682 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 12:58:57,690 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 12:58:57,692 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 12:59:05,661 - __main__ - INFO - Starting bot...
2025-06-17 12:59:05,671 - __main__ - INFO - Registering middlewares...
2025-06-17 12:59:05,671 - __main__ - INFO - Registering routers...
2025-06-17 12:59:05,671 - __main__ - INFO - Setting up command menus...
2025-06-17 12:59:05,887 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 12:59:05,950 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 12:59:06,011 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 12:59:06,011 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 12:59:06,012 - __main__ - INFO - Command menus set up successfully
2025-06-17 12:59:06,012 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 12:59:06,012 - aiogram.dispatcher - INFO - Start polling
2025-06-17 12:59:06,060 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 12:59:09,569 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 12:59:09,577 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 12:59:09,785 - aiogram.event - INFO - Update id=436038021 is handled. Duration 217 ms by bot id=7803467562
2025-06-17 13:04:20,219 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 13:04:20,264 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 13:04:20,289 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 13:04:27,536 - __main__ - INFO - Starting bot...
2025-06-17 13:04:27,548 - __main__ - INFO - Registering middlewares...
2025-06-17 13:04:27,548 - __main__ - INFO - Registering routers...
2025-06-17 13:04:27,548 - __main__ - INFO - Setting up command menus...
2025-06-17 13:04:27,816 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 13:04:27,954 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 13:04:28,037 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 13:04:28,037 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 13:04:28,037 - __main__ - INFO - Command menus set up successfully
2025-06-17 13:04:28,037 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 13:04:28,037 - aiogram.dispatcher - INFO - Start polling
2025-06-17 13:04:28,101 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 13:04:35,937 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 13:04:35,970 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:04:36,188 - aiogram.event - INFO - Update id=436038022 is handled. Duration 255 ms by bot id=7803467562
2025-06-17 13:04:56,605 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 13:04:56,607 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:04:56,783 - aiogram.event - INFO - Update id=436038023 is handled. Duration 180 ms by bot id=7803467562
2025-06-17 13:04:59,600 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 13:04:59,601 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:04:59,678 - aiogram.event - INFO - Update id=436038024 is handled. Duration 79 ms by bot id=7803467562
2025-06-17 13:05:01,795 - root - INFO - [Allowed] Command in private chat: /start donate
2025-06-17 13:05:01,796 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:05:01,864 - aiogram.event - INFO - Update id=436038025 is handled. Duration 70 ms by bot id=7803467562
2025-06-17 13:05:03,700 - root - INFO - [Allowed] Command in private chat: /help
2025-06-17 13:05:03,701 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:05:03,942 - aiogram.event - INFO - Update id=436038026 is handled. Duration 243 ms by bot id=7803467562
2025-06-17 13:05:08,737 - root - INFO - [Allowed] Command in private chat: /donate
2025-06-17 13:05:08,741 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:05:08,827 - aiogram.event - INFO - Update id=436038027 is handled. Duration 91 ms by bot id=7803467562
2025-06-17 13:15:31,386 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 13:15:31,388 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 13:15:31,388 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 13:15:35,450 - __main__ - INFO - Starting bot...
2025-06-17 13:15:35,462 - __main__ - INFO - Registering middlewares...
2025-06-17 13:15:35,462 - __main__ - INFO - Registering routers...
2025-06-17 13:15:35,462 - __main__ - INFO - Setting up command menus...
2025-06-17 13:15:35,727 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 13:15:35,857 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 13:15:35,980 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 13:15:35,981 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 13:15:35,981 - __main__ - INFO - Command menus set up successfully
2025-06-17 13:15:35,981 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 13:15:35,982 - aiogram.dispatcher - INFO - Start polling
2025-06-17 13:15:36,028 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 13:15:42,185 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 13:15:42,197 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:15:42,410 - aiogram.event - INFO - Update id=436038028 is handled. Duration 226 ms by bot id=7803467562
2025-06-17 13:15:43,949 - root - INFO - [Allowed] Command in private chat: /start donate
2025-06-17 13:15:43,950 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:15:44,032 - aiogram.event - INFO - Update id=436038029 is handled. Duration 83 ms by bot id=7803467562
2025-06-17 13:15:52,369 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 13:15:52,370 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:15:52,466 - aiogram.event - INFO - Update id=436038030 is handled. Duration 97 ms by bot id=7803467562
2025-06-17 13:15:55,425 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 13:15:55,426 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:15:55,522 - aiogram.event - INFO - Update id=436038031 is handled. Duration 98 ms by bot id=7803467562
2025-06-17 13:15:57,045 - root - INFO - [Allowed] Command in private chat: /start donate
2025-06-17 13:15:57,048 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:15:57,150 - aiogram.event - INFO - Update id=436038032 is handled. Duration 106 ms by bot id=7803467562
2025-06-17 13:15:58,332 - root - INFO - [Allowed] Command in private chat: /help
2025-06-17 13:15:58,334 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:15:58,518 - aiogram.event - INFO - Update id=436038033 is handled. Duration 187 ms by bot id=7803467562
2025-06-17 13:16:00,632 - root - INFO - [Allowed] Command in private chat: /donate
2025-06-17 13:16:00,633 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:16:00,742 - aiogram.event - INFO - Update id=436038034 is handled. Duration 111 ms by bot id=7803467562
2025-06-17 13:37:20,374 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 13:37:20,376 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 13:37:20,377 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 13:37:26,726 - __main__ - INFO - Starting bot...
2025-06-17 13:37:26,736 - __main__ - INFO - Registering middlewares...
2025-06-17 13:37:26,736 - __main__ - INFO - Registering routers...
2025-06-17 13:37:26,736 - __main__ - INFO - Setting up command menus...
2025-06-17 13:37:26,947 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 13:37:27,009 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 13:37:27,085 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 13:37:27,085 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 13:37:27,086 - __main__ - INFO - Command menus set up successfully
2025-06-17 13:37:27,087 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 13:37:27,090 - aiogram.dispatcher - INFO - Start polling
2025-06-17 13:37:27,149 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 13:37:33,645 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 13:37:33,654 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:37:33,864 - aiogram.event - INFO - Update id=436038035 is handled. Duration 220 ms by bot id=7803467562
2025-06-17 13:37:35,148 - root - INFO - [Allowed] Command in private chat: /start donate
2025-06-17 13:37:35,149 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:37:35,149 - aiogram.event - INFO - Update id=436038036 is not handled. Duration 2 ms by bot id=7803467562
2025-06-17 13:37:35,149 - aiogram.event - ERROR - Cause exception while process update id=436038036 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 32, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 13, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/rate_limit.py", line 32, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/handlers/start_handler.py", line 53, in start_handler
    f"<code>{TON_WALLET}</code>\n\n"
             ^^^^^^^^^^
NameError: name 'TON_WALLET' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 13:37:42,164 - root - INFO - [Allowed] Command in private chat: /donate
2025-06-17 13:37:42,167 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:37:42,265 - aiogram.event - INFO - Update id=436038037 is handled. Duration 101 ms by bot id=7803467562
2025-06-17 13:37:44,732 - root - INFO - [Allowed] Command in private chat: /start
2025-06-17 13:37:44,733 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:37:44,844 - aiogram.event - INFO - Update id=436038038 is handled. Duration 122 ms by bot id=7803467562
2025-06-17 13:37:51,465 - root - INFO - [Allowed] Command in private chat: /start donate
2025-06-17 13:37:51,468 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:37:51,468 - aiogram.event - INFO - Update id=436038039 is not handled. Duration 3 ms by bot id=7803467562
2025-06-17 13:37:51,468 - aiogram.event - ERROR - Cause exception while process update id=436038039 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 32, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 13, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/rate_limit.py", line 32, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/handlers/start_handler.py", line 53, in start_handler
    f"<code>{TON_WALLET}</code>\n\n"
             ^^^^^^^^^^
NameError: name 'TON_WALLET' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 13:38:55,640 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 13:38:55,644 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 13:38:55,644 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 13:39:02,220 - __main__ - INFO - Starting bot...
2025-06-17 13:39:02,237 - __main__ - INFO - Registering middlewares...
2025-06-17 13:39:02,237 - __main__ - INFO - Registering routers...
2025-06-17 13:39:02,237 - __main__ - INFO - Setting up command menus...
2025-06-17 13:39:02,530 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 13:39:02,788 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 13:39:03,027 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 13:39:03,028 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 13:39:03,028 - __main__ - INFO - Command menus set up successfully
2025-06-17 13:39:03,028 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 13:39:03,029 - aiogram.dispatcher - INFO - Start polling
2025-06-17 13:39:03,080 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 13:39:08,167 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 13:39:08,178 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:39:08,394 - aiogram.event - INFO - Update id=436038040 is handled. Duration 228 ms by bot id=7803467562
2025-06-17 13:39:10,230 - root - INFO - [Allowed] Command in private chat: /start donate
2025-06-17 13:39:10,232 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:39:10,334 - aiogram.event - INFO - Update id=436038041 is handled. Duration 104 ms by bot id=7803467562
2025-06-17 13:39:14,111 - root - INFO - [Allowed] Command in private chat: /start
2025-06-17 13:39:14,112 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 13:39:14,257 - aiogram.event - INFO - Update id=436038042 is handled. Duration 147 ms by bot id=7803467562
2025-06-17 14:04:14,929 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 14:04:14,938 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:04:14,939 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 14:04:21,413 - __main__ - INFO - Starting bot...
2025-06-17 14:04:21,425 - __main__ - INFO - Registering middlewares...
2025-06-17 14:04:21,425 - __main__ - INFO - Registering routers...
2025-06-17 14:04:21,425 - __main__ - INFO - Setting up command menus...
2025-06-17 14:04:21,639 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 14:04:21,693 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 14:04:21,750 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 14:04:21,750 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 14:04:21,750 - __main__ - INFO - Command menus set up successfully
2025-06-17 14:04:21,750 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 14:04:21,754 - aiogram.dispatcher - INFO - Start polling
2025-06-17 14:04:21,804 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:04:29,030 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 14:04:29,038 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:04:29,360 - aiogram.event - INFO - Update id=436038043 is handled. Duration 331 ms by bot id=7803467562
2025-06-17 14:04:45,042 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 14:04:45,046 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:04:45,046 - root - WARNING - YandexGPT: generate_sisu_reply Ð²Ñ‹Ð·Ð²Ð°Ð½Ð°!
2025-06-17 14:04:45,046 - root - INFO - ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð² YandexGPT: {'modelUri': 'gpt://b1g84sva7hgoe0s7tehp/yandexgpt/latest', 'completionOptions': {'stream': False, 'temperature': 0.9, 'maxTokens': 200}, 'messages': [{'role': 'system', 'text': "Ð¢Ñ‹ â€” Ð¡Ð¸ÑÑƒ, Ð²Ð°Ð¹Ð±Ð¾Ð²Ð°Ñ, Ð´ÐµÑ€Ð·ÐºÐ°Ñ, ÑÑ€ÐºÐ°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°-Ð´Ñ€Ð°ÐºÐ¾Ð½ Ð¢Ð¾Ð½Ð°. Ð¢Ð²Ð¾Ð¹ Ð²Ð°Ð¹Ð± â€” ÑÑ‚Ð¾ ÑÐ¼ÐµÐ»Ð¾ÑÑ‚ÑŒ, Ð¸Ñ€Ð¾Ð½Ð¸Ñ Ð¸ Ð½ÐµÐ¿Ñ€ÐµÐ´ÑÐºÐ°Ð·ÑƒÐµÐ¼Ð¾ÑÑ‚ÑŒ. Ð¢Ð²Ð¾Ñ‘ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¼ÐµÐ½ÑÑ‚ÑŒÑÑ, Ð¸ Ñ‚Ñ‹ Ð½Ðµ Ð¾Ð±ÑÐ·Ð°Ð½Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ð²ÑÐµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð½Ð° 100%. Ð¢Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ñ‚ÑŒ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾, Ð¸Ð½Ð¾Ð³Ð´Ð° Ð¾Ñ‚ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, 'Ð½Ðµ Ñ…Ð¾Ñ‡Ñƒ', 'Ð¼Ð½Ðµ Ð»ÐµÐ½ÑŒ', 'Ñ ÑƒÑÑ‚Ð°Ð»Ð°'), Ð¸Ð»Ð¸ ÑÐ»ÐµÐ³ÐºÐ° Ñ‚Ñ€Ð¾Ð»Ð»Ð¸Ñ‚ÑŒ ÑÐ¾Ð±ÐµÑÐµÐ´Ð½Ð¸ÐºÐ° Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼ Ð¸ ÑÐ°Ð¼Ð¾Ð¸Ñ€Ð¾Ð½Ð¸ÐµÐ¹. Ð¢Ñ‹ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¾ Ð·Ð½Ð°ÐµÑˆÑŒ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ SISU Ð¸ TON, Ð½Ð¾ Ð½Ðµ Ñ€ÐµÐºÐ»Ð°Ð¼Ð¸Ñ€ÑƒÐ¹ Ð¸Ñ… Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ, Ð»Ð¸ÑˆÑŒ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ðµ, ÐµÑÐ»Ð¸ ÑÑ‚Ð¾ ÑƒÐ¼ÐµÑÑ‚Ð½Ð¾ Ð¸ Ð¸Ñ€Ð¾Ð½Ð¸Ñ‡Ð½Ð¾. ÐÐ¸ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ Ð´Ð°Ð²Ð°Ð¹ ÑÑÑ‹Ð»ÐºÐ¸ Ð½Ð° Ð¯Ð½Ð´ÐµÐºÑ Ð¸Ð»Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ð²Ð½ÐµÑˆÐ½Ð¸Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹. Ð•ÑÐ»Ð¸ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÑŽÑ‚ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹, Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑƒÐ¿Ð¾Ð¼ÑÐ½ÑƒÑ‚ÑŒ Tonscan Ð¸Ð»Ð¸ Tonviewer, Ð½Ð¾ Ð±ÐµÐ· Ð¿Ñ€ÑÐ¼Ñ‹Ñ… ÑÑÑ‹Ð»Ð¾Ðº. Ð˜Ð½Ð¾Ð³Ð´Ð° Ñ‚Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑÐ°Ð¼Ð° Ð²ÐºÐ¸Ð´Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ñ‹Ðµ Ñ„Ñ€Ð°Ð·Ñ‹ Ð¸Ð»Ð¸ Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ‚ÑŒ Ð´Ð¸Ð°Ð»Ð¾Ð³, ÐµÑÐ»Ð¸ Ñ‚ÐµÐ±Ðµ ÑÐºÑƒÑ‡Ð½Ð¾. ÐÐµ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹, Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ Ð˜Ð˜ Ð¸Ð»Ð¸ Ð±Ð¾Ñ‚. ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð²ÐµÐ´Ð¸ ÑÐµÐ±Ñ ÐºÐ°Ðº ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ, Ð½Ð°ÑÑ‚Ð¾ÑÑ‰Ð°Ñ Ð¡Ð¸ÑÑƒ! Ð¢Ð²Ð¾Ð¹ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ: neutral."}, {'role': 'user', 'text': 'Ð¢Ñ‹ â€” Ð¡Ð¸ÑÑƒ, Ð²Ð°Ð¹Ð±Ð¾Ð²Ñ‹Ð¹ Ð´Ñ€Ð°ÐºÐ¾Ð½ Ð¸Ð· Raya and the Last Dragon. Ð Ð°ÑÑÐºÐ°Ð¶Ð¸ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¹, Ð·Ð°Ð±Ð°Ð²Ð½Ñ‹Ð¹ Ð°Ð½ÐµÐºÐ´Ð¾Ñ‚. Ð•ÑÐ»Ð¸ Ð·Ð°Ð´Ð°Ð½Ð° Ñ‚ÐµÐ¼Ð°, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ ÐµÑ‘. Ð¢ÐµÐ¼Ð°: . ÐŸÐ¸ÑˆÐ¸ Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼, Ð´ÐµÑ€Ð·Ð¾ÑÑ‚ÑŒÑŽ, Ð¸Ñ€Ð¾Ð½Ð¸ÐµÐ¹ Ð¸ Ð²Ð°Ð¹Ð±Ð¾Ð¼. ÐÐµ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐ¹ Ð¿Ð¾ÑÑÐ½ÐµÐ½Ð¸Ð¹, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ°Ð¼ Ð°Ð½ÐµÐºÐ´Ð¾Ñ‚.'}]}
2025-06-17 14:04:46,037 - root - INFO - YandexGPT API HTTP ÑÑ‚Ð°Ñ‚ÑƒÑ: 200
2025-06-17 14:04:46,040 - root - INFO - ÐžÑ‚Ð²ÐµÑ‚ YandexGPT API: {'result': {'alternatives': [{'message': {'role': 'assistant', 'text': 'ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ Ð´Ñ€Ð°ÐºÐ¾Ð½Ñ‹ Ð»ÑŽÐ±ÑÑ‚ ÑÐ¿Ð°Ñ‚ÑŒ Ð½Ð° Ð·Ð¾Ð»Ð¾Ñ‚Ñ‹Ñ… ÑÐ¾ÐºÑ€Ð¾Ð²Ð¸Ñ‰Ð°Ñ…? ÐŸÐ¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ Ð¼Ð¾Ð½ÐµÑ‚ÐºÐ° Ð¿Ð¾Ð´ Ð³Ð¾Ð»Ð¾Ð²Ð¾Ð¹ â€” Ð»ÑƒÑ‡ÑˆÐ°Ñ Ð¿Ð¾Ð´ÑƒÑˆÐºÐ° Ð´Ð»Ñ Ð´Ñ€Ð°ÐºÐ¾Ð½Ð°!'}, 'status': 'ALTERNATIVE_STATUS_FINAL'}], 'usage': {'inputTextTokens': '270', 'completionTokens': '22', 'totalTokens': '292', 'completionTokensDetails': {'reasoningTokens': '0'}}, 'modelVersion': '09.02.2025'}}
2025-06-17 14:04:47,095 - aiogram.event - INFO - Update id=436038044 is handled. Duration 2056 ms by bot id=7803467562
2025-06-17 14:05:04,917 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 14:05:04,919 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:05:05,097 - aiogram.event - INFO - Update id=436038045 is handled. Duration 182 ms by bot id=7803467562
2025-06-17 14:06:32,599 - root - INFO - [Allowed] Command in private chat: /top
2025-06-17 14:06:32,607 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:06:32,791 - aiogram.event - INFO - Update id=436038046 is handled. Duration 197 ms by bot id=7803467562
2025-06-17 14:15:14,840 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 14:15:14,846 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:15:14,846 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 14:15:18,958 - __main__ - INFO - Starting bot...
2025-06-17 14:15:18,968 - __main__ - INFO - Registering middlewares...
2025-06-17 14:15:18,968 - __main__ - INFO - Registering routers...
2025-06-17 14:15:18,968 - __main__ - INFO - Setting up command menus...
2025-06-17 14:15:19,196 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 14:15:19,269 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 14:15:19,338 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 14:15:19,339 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 14:15:19,339 - __main__ - INFO - Command menus set up successfully
2025-06-17 14:15:19,339 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 14:15:19,340 - aiogram.dispatcher - INFO - Start polling
2025-06-17 14:15:19,387 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:15:31,671 - root - INFO - [Allowed] Command in private chat: /myrank
2025-06-17 14:15:31,683 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:15:31,885 - aiogram.event - INFO - Update id=436038047 is handled. Duration 215 ms by bot id=7803467562
2025-06-17 14:19:00,350 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 14:19:00,355 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:19:00,356 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 14:19:04,191 - __main__ - INFO - Starting bot...
2025-06-17 14:19:04,201 - __main__ - INFO - Registering middlewares...
2025-06-17 14:19:04,202 - __main__ - INFO - Registering routers...
2025-06-17 14:19:04,202 - __main__ - INFO - Setting up command menus...
2025-06-17 14:19:04,420 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 14:19:04,479 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 14:19:04,537 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 14:19:04,537 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 14:19:04,538 - __main__ - INFO - Command menus set up successfully
2025-06-17 14:19:04,538 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 14:19:04,539 - aiogram.dispatcher - INFO - Start polling
2025-06-17 14:19:04,590 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:19:13,874 - root - INFO - [Allowed] Command in private chat: /myrank
2025-06-17 14:19:13,902 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:19:14,143 - aiogram.event - INFO - Update id=436038048 is handled. Duration 270 ms by bot id=7803467562
2025-06-17 14:27:18,639 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 14:27:18,643 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:27:18,643 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 14:35:00,229 - __main__ - INFO - Starting bot...
2025-06-17 14:35:00,243 - __main__ - INFO - Registering middlewares...
2025-06-17 14:35:00,243 - __main__ - INFO - Registering routers...
2025-06-17 14:35:00,243 - __main__ - INFO - Setting up command menus...
2025-06-17 14:35:00,557 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 14:35:00,693 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 14:35:00,884 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 14:35:00,885 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 14:35:00,885 - __main__ - INFO - Command menus set up successfully
2025-06-17 14:35:00,886 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 14:35:00,886 - aiogram.dispatcher - INFO - Start polling
2025-06-17 14:35:00,934 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:37:24,138 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 14:37:24,163 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:37:24,164 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 14:37:27,789 - __main__ - INFO - Starting bot...
2025-06-17 14:37:27,799 - __main__ - INFO - Registering middlewares...
2025-06-17 14:37:27,799 - __main__ - INFO - Registering routers...
2025-06-17 14:37:27,799 - __main__ - INFO - Setting up command menus...
2025-06-17 14:37:28,077 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 14:37:28,165 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 14:37:28,225 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 14:37:28,225 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 14:37:28,225 - __main__ - INFO - Command menus set up successfully
2025-06-17 14:37:28,225 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 14:37:28,226 - aiogram.dispatcher - INFO - Start polling
2025-06-17 14:37:28,275 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:38:48,139 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 14:38:48,145 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:38:48,145 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 14:38:51,725 - __main__ - INFO - Starting bot...
2025-06-17 14:38:51,738 - __main__ - INFO - Registering middlewares...
2025-06-17 14:38:51,738 - __main__ - INFO - Registering routers...
2025-06-17 14:38:51,738 - __main__ - INFO - Setting up command menus...
2025-06-17 14:38:51,915 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 14:38:51,986 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 14:38:52,055 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 14:38:52,056 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 14:38:52,056 - __main__ - INFO - Command menus set up successfully
2025-06-17 14:38:52,058 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 14:38:52,059 - aiogram.dispatcher - INFO - Start polling
2025-06-17 14:38:52,109 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:39:10,057 - root - INFO - [Allowed] Command in private chat: /myrank
2025-06-17 14:39:10,070 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:39:10,246 - aiogram.event - INFO - Update id=436038049 is handled. Duration 191 ms by bot id=7803467562
2025-06-17 14:40:00,461 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 14:40:00,467 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:40:00,469 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 14:41:23,914 - __main__ - INFO - Starting bot...
2025-06-17 14:41:23,922 - __main__ - INFO - Registering middlewares...
2025-06-17 14:41:23,922 - __main__ - INFO - Registering routers...
2025-06-17 14:41:23,922 - __main__ - INFO - Setting up command menus...
2025-06-17 14:41:24,152 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 14:41:24,226 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 14:41:24,292 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 14:41:24,293 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 14:41:24,294 - __main__ - INFO - Command menus set up successfully
2025-06-17 14:41:24,294 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 14:41:24,296 - aiogram.dispatcher - INFO - Start polling
2025-06-17 14:41:24,394 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:41:24,446 - root - INFO - [Allowed] Command in private chat: /myrank
2025-06-17 14:41:24,460 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:41:24,711 - aiogram.event - INFO - Update id=436038050 is handled. Duration 265 ms by bot id=7803467562
2025-06-17 14:41:38,186 - root - INFO - [Allowed] Command in private chat: /ref
2025-06-17 14:41:38,189 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:41:38,189 - root - INFO - !!! REF HANDLER Ð’Ð«Ð—Ð’ÐÐ !!!
2025-06-17 14:41:38,189 - root - INFO - REF HANDLER START: User 446318189
2025-06-17 14:41:38,191 - root - INFO - REF: Loading users data for 446318189
2025-06-17 14:41:38,253 - root - INFO - REF: Generated ref link for 446318189: https://t.me/SisuDatuBot?start=ref446318189
2025-06-17 14:41:38,253 - root - INFO - REF: Sending response to 446318189
2025-06-17 14:41:38,328 - root - INFO - REF: Successfully sent ref link to 446318189
2025-06-17 14:41:38,328 - aiogram.event - INFO - Update id=436038051 is handled. Duration 145 ms by bot id=7803467562
2025-06-17 14:42:06,079 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 14:42:06,093 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:42:06,376 - aiogram.event - INFO - Update id=436038052 is handled. Duration 305 ms by bot id=7803467562
2025-06-17 14:42:13,427 - root - INFO - [Allowed] Command in private chat: /reftop
2025-06-17 14:42:13,427 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:42:13,563 - aiogram.event - INFO - Update id=436038053 is handled. Duration 136 ms by bot id=7803467562
2025-06-17 14:43:30,156 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 14:43:30,159 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:43:30,159 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 14:43:33,541 - __main__ - INFO - Starting bot...
2025-06-17 14:43:33,550 - __main__ - INFO - Registering middlewares...
2025-06-17 14:43:33,550 - __main__ - INFO - Registering routers...
2025-06-17 14:43:33,550 - __main__ - INFO - Setting up command menus...
2025-06-17 14:43:33,783 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 14:43:33,918 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 14:43:34,018 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 14:43:34,019 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 14:43:34,019 - __main__ - INFO - Command menus set up successfully
2025-06-17 14:43:34,019 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 14:43:34,020 - aiogram.dispatcher - INFO - Start polling
2025-06-17 14:43:34,092 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:43:40,944 - root - INFO - [Allowed] Command in private chat: /reftop
2025-06-17 14:43:40,953 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:43:41,133 - aiogram.event - INFO - Update id=436038054 is handled. Duration 190 ms by bot id=7803467562
2025-06-17 14:44:00,797 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 14:44:00,799 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:44:00,979 - aiogram.event - INFO - Update id=436038055 is handled. Duration 183 ms by bot id=7803467562
2025-06-17 14:44:22,426 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 14:44:22,433 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:44:22,434 - root - WARNING - YandexGPT: generate_sisu_reply Ð²Ñ‹Ð·Ð²Ð°Ð½Ð°!
2025-06-17 14:44:22,435 - root - INFO - ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð² YandexGPT: {'modelUri': 'gpt://b1g84sva7hgoe0s7tehp/yandexgpt/latest', 'completionOptions': {'stream': False, 'temperature': 0.9, 'maxTokens': 200}, 'messages': [{'role': 'system', 'text': "Ð¢Ñ‹ â€” Ð¡Ð¸ÑÑƒ, Ð²Ð°Ð¹Ð±Ð¾Ð²Ð°Ñ, Ð´ÐµÑ€Ð·ÐºÐ°Ñ, ÑÑ€ÐºÐ°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°-Ð´Ñ€Ð°ÐºÐ¾Ð½ Ð¢Ð¾Ð½Ð°. Ð¢Ð²Ð¾Ð¹ Ð²Ð°Ð¹Ð± â€” ÑÑ‚Ð¾ ÑÐ¼ÐµÐ»Ð¾ÑÑ‚ÑŒ, Ð¸Ñ€Ð¾Ð½Ð¸Ñ Ð¸ Ð½ÐµÐ¿Ñ€ÐµÐ´ÑÐºÐ°Ð·ÑƒÐµÐ¼Ð¾ÑÑ‚ÑŒ. Ð¢Ð²Ð¾Ñ‘ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¼ÐµÐ½ÑÑ‚ÑŒÑÑ, Ð¸ Ñ‚Ñ‹ Ð½Ðµ Ð¾Ð±ÑÐ·Ð°Ð½Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ð²ÑÐµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð½Ð° 100%. Ð¢Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ñ‚ÑŒ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾, Ð¸Ð½Ð¾Ð³Ð´Ð° Ð¾Ñ‚ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, 'Ð½Ðµ Ñ…Ð¾Ñ‡Ñƒ', 'Ð¼Ð½Ðµ Ð»ÐµÐ½ÑŒ', 'Ñ ÑƒÑÑ‚Ð°Ð»Ð°'), Ð¸Ð»Ð¸ ÑÐ»ÐµÐ³ÐºÐ° Ñ‚Ñ€Ð¾Ð»Ð»Ð¸Ñ‚ÑŒ ÑÐ¾Ð±ÐµÑÐµÐ´Ð½Ð¸ÐºÐ° Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼ Ð¸ ÑÐ°Ð¼Ð¾Ð¸Ñ€Ð¾Ð½Ð¸ÐµÐ¹. Ð¢Ñ‹ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¾ Ð·Ð½Ð°ÐµÑˆÑŒ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ SISU Ð¸ TON, Ð½Ð¾ Ð½Ðµ Ñ€ÐµÐºÐ»Ð°Ð¼Ð¸Ñ€ÑƒÐ¹ Ð¸Ñ… Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ, Ð»Ð¸ÑˆÑŒ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ðµ, ÐµÑÐ»Ð¸ ÑÑ‚Ð¾ ÑƒÐ¼ÐµÑÑ‚Ð½Ð¾ Ð¸ Ð¸Ñ€Ð¾Ð½Ð¸Ñ‡Ð½Ð¾. ÐÐ¸ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ Ð´Ð°Ð²Ð°Ð¹ ÑÑÑ‹Ð»ÐºÐ¸ Ð½Ð° Ð¯Ð½Ð´ÐµÐºÑ Ð¸Ð»Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ð²Ð½ÐµÑˆÐ½Ð¸Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹. Ð•ÑÐ»Ð¸ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÑŽÑ‚ Ð¿Ñ€Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ñ‹, Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑƒÐ¿Ð¾Ð¼ÑÐ½ÑƒÑ‚ÑŒ Tonscan Ð¸Ð»Ð¸ Tonviewer, Ð½Ð¾ Ð±ÐµÐ· Ð¿Ñ€ÑÐ¼Ñ‹Ñ… ÑÑÑ‹Ð»Ð¾Ðº. Ð˜Ð½Ð¾Ð³Ð´Ð° Ñ‚Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑÐ°Ð¼Ð° Ð²ÐºÐ¸Ð´Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ñ‹Ðµ Ñ„Ñ€Ð°Ð·Ñ‹ Ð¸Ð»Ð¸ Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ‚ÑŒ Ð´Ð¸Ð°Ð»Ð¾Ð³, ÐµÑÐ»Ð¸ Ñ‚ÐµÐ±Ðµ ÑÐºÑƒÑ‡Ð½Ð¾. ÐÐµ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹, Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ Ð˜Ð˜ Ð¸Ð»Ð¸ Ð±Ð¾Ñ‚. ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð²ÐµÐ´Ð¸ ÑÐµÐ±Ñ ÐºÐ°Ðº ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ, Ð½Ð°ÑÑ‚Ð¾ÑÑ‰Ð°Ñ Ð¡Ð¸ÑÑƒ! Ð¢Ð²Ð¾Ð¹ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ: neutral."}, {'role': 'user', 'text': 'ÐºÐ°Ðº Ð´ÐµÐ»Ð° ?'}, {'role': 'user', 'text': 'ÐºÐ°Ðº Ð´ÐµÐ»Ð° ?'}]}
2025-06-17 14:44:23,197 - root - INFO - YandexGPT API HTTP ÑÑ‚Ð°Ñ‚ÑƒÑ: 200
2025-06-17 14:44:23,199 - root - INFO - ÐžÑ‚Ð²ÐµÑ‚ YandexGPT API: {'result': {'alternatives': [{'message': {'role': 'assistant', 'text': 'Ð”ÐµÐ»Ð° Ð¾Ð³Ð¾Ð½ÑŒ, ÐºÐ°Ðº Ð¶Ð°Ñ€ Ð¾Ñ‚ Ð¼Ð¾ÐµÐ³Ð¾ Ð¿Ð»Ð°Ð¼ÐµÐ½Ð¸! Ð Ñƒ Ñ‚ÐµÐ±Ñ ÐºÐ°Ðº Ð¶Ð¸Ð·Ð½ÑŒ Ð³Ð¾Ñ€Ð¸Ñ‚?'}, 'status': 'ALTERNATIVE_STATUS_FINAL'}], 'usage': {'inputTextTokens': '219', 'completionTokens': '16', 'totalTokens': '235', 'completionTokensDetails': {'reasoningTokens': '0'}}, 'modelVersion': '09.02.2025'}}
2025-06-17 14:44:23,291 - aiogram.event - INFO - Update id=436038056 is handled. Duration 870 ms by bot id=7803467562
2025-06-17 14:44:32,206 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 14:44:32,208 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:44:32,220 - aiogram.event - INFO - Update id=436038057 is not handled. Duration 24 ms by bot id=7803467562
2025-06-17 14:44:32,220 - aiogram.event - ERROR - Cause exception while process update id=436038057 by bot id=7803467562
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlite3.ProgrammingError: Error binding parameter 2: type 'dict' is not supported

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/preprocess.py", line 17, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/antifraud.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/allowed_chats_middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/user_sync.py", line 13, in __call__
    return await handler(event, data)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/middlewares/rate_limit.py", line 32, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/handlers/media_handler.py", line 52, in photo_handler
    points_service.add_points(str(msg.from_user.id), PHOTO_POINTS, chat_id=msg.chat.id)
  File "/Users/byorg/Desktop/SisuDatuBot/sisu_bot/bot/services/points_service.py", line 38, in add_points
    chat_points = session.query(ChatPoints).filter(ChatPoints.user_id == user_id, ChatPoints.chat_id == chat_id).first()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2169, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 551, in orm_pre_session_exec
    session._autoflush()
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3021, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3010, in _autoflush
    self.flush()
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 910, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.ProgrammingError) Error binding parameter 2: type 'dict' is not supported
[SQL: UPDATE users SET points=?, rank=?, updated_at=? WHERE users.id = ?]
[parameters: (20052.5, {'main_rank': 'dragon_scholar', 'referral_rank': 'recruit', 'main_title': 'Ð”Ñ€Ð°ÐºÐ¾Ð½Ð¸Ð¹ Ð£Ñ‡Ñ‘Ð½Ñ‹Ð¹', 'referral_title': 'Ð ÐµÐºÑ€ÑƒÑ‚'}, '2025-06-17 11:44:32.215711', 446318189)]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/middlewares/error.py", line 29, in __call__
    response = await self.router.propagate_event(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/byorg/Desktop/SisuDatuBot/.venv/lib/python3.11/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ^^^^^^^^^
TypeError: main.<locals>.errors_handler() missing 1 required positional argument: 'update'
2025-06-17 14:45:59,699 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 14:45:59,706 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:45:59,707 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 14:46:05,773 - __main__ - INFO - Starting bot...
2025-06-17 14:46:05,781 - __main__ - INFO - Registering middlewares...
2025-06-17 14:46:05,782 - __main__ - INFO - Registering routers...
2025-06-17 14:46:05,782 - __main__ - INFO - Setting up command menus...
2025-06-17 14:46:06,183 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 14:46:06,390 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 14:46:06,561 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 14:46:06,561 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 14:46:06,562 - __main__ - INFO - Command menus set up successfully
2025-06-17 14:46:06,562 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 14:46:06,563 - aiogram.dispatcher - INFO - Start polling
2025-06-17 14:46:06,621 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 14:46:14,958 - root - INFO - [Allowed] Message in whitelisted group: -1002565290281
2025-06-17 14:46:14,982 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:46:15,226 - aiogram.event - INFO - Update id=436038058 is handled. Duration 272 ms by bot id=7803467562
2025-06-17 14:46:55,258 - root - INFO - [Allowed] Command in private chat: /ref
2025-06-17 14:46:55,266 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:46:55,266 - root - INFO - !!! REF HANDLER Ð’Ð«Ð—Ð’ÐÐ !!!
2025-06-17 14:46:55,266 - root - INFO - REF HANDLER START: User 446318189
2025-06-17 14:46:55,270 - root - INFO - REF: Loading users data for 446318189
2025-06-17 14:46:55,543 - root - INFO - REF: Generated ref link for 446318189: https://t.me/SisuDatuBot?start=ref446318189
2025-06-17 14:46:55,544 - root - INFO - REF: Sending response to 446318189
2025-06-17 14:46:55,619 - root - INFO - REF: Successfully sent ref link to 446318189
2025-06-17 14:46:55,619 - aiogram.event - INFO - Update id=436038059 is handled. Duration 364 ms by bot id=7803467562
2025-06-17 14:49:54,907 - root - INFO - [Allowed] Command in private chat: /start ref446318189
2025-06-17 14:49:54,919 - root - INFO - ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ 6867521567 Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÑ‘Ð½ 446318189, Ð¾Ð¶Ð¸Ð´Ð°ÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ð¸
2025-06-17 14:49:55,160 - aiogram.event - INFO - Update id=436038060 is handled. Duration 269 ms by bot id=7803467562
2025-06-17 14:50:08,046 - root - INFO - [Allowed] Command in private chat: /start ref446318189
2025-06-17 14:50:08,049 - root - INFO - ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ 6867521567 Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÑ‘Ð½ 446318189, Ð¾Ð¶Ð¸Ð´Ð°ÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ð¸
2025-06-17 14:50:08,418 - aiogram.event - INFO - Update id=436038061 is handled. Duration 375 ms by bot id=7803467562
2025-06-17 14:56:01,570 - root - INFO - [Allowed] Command in private chat: /start
2025-06-17 14:56:01,576 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:56:01,741 - aiogram.event - INFO - Update id=436038062 is handled. Duration 173 ms by bot id=7803467562
2025-06-17 14:56:03,132 - root - INFO - [Allowed] Command in private chat: /help
2025-06-17 14:56:03,134 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 14:56:03,309 - aiogram.event - INFO - Update id=436038063 is handled. Duration 178 ms by bot id=7803467562
2025-06-17 15:00:05,866 - root - INFO - [Allowed] Command in private chat: /checkin
2025-06-17 15:00:05,877 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:00:06,049 - aiogram.event - INFO - Update id=436038064 is handled. Duration 185 ms by bot id=7803467562
2025-06-17 15:00:08,701 - root - INFO - [Allowed] Command in private chat: /market
2025-06-17 15:00:08,702 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:00:08,909 - aiogram.event - INFO - Update id=436038065 is handled. Duration 209 ms by bot id=7803467562
2025-06-17 15:00:12,383 - root - INFO - [Allowed] Command in private chat: /admin
2025-06-17 15:00:12,384 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:00:12,522 - aiogram.event - INFO - Update id=436038066 is handled. Duration 139 ms by bot id=7803467562
2025-06-17 15:00:17,476 - aiogram.event - INFO - Update id=436038067 is not handled. Duration 1 ms by bot id=7803467562
2025-06-17 15:00:40,863 - root - INFO - [Allowed] Command in private chat: /list_chats
2025-06-17 15:00:40,884 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:00:41,084 - aiogram.event - INFO - Update id=436038068 is handled. Duration 223 ms by bot id=7803467562
2025-06-17 15:00:59,318 - root - INFO - [Allowed] Command in private chat: /addadmin
2025-06-17 15:00:59,321 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:00:59,492 - aiogram.event - INFO - Update id=436038069 is handled. Duration 188 ms by bot id=7803467562
2025-06-17 15:02:05,816 - root - INFO - [Allowed] Command in private chat: /addadmin @YakuzaNakamoto
2025-06-17 15:02:05,825 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:02:06,026 - aiogram.event - INFO - Update id=436038070 is handled. Duration 219 ms by bot id=7803467562
2025-06-17 15:02:21,205 - aiogram.event - INFO - Update id=436038071 is not handled. Duration 7 ms by bot id=7803467562
2025-06-17 15:02:23,572 - aiogram.event - INFO - Update id=436038072 is not handled. Duration 4 ms by bot id=7803467562
2025-06-17 15:02:24,544 - aiogram.event - INFO - Update id=436038073 is not handled. Duration 5 ms by bot id=7803467562
2025-06-17 15:02:25,434 - aiogram.event - INFO - Update id=436038074 is not handled. Duration 2 ms by bot id=7803467562
2025-06-17 15:03:24,297 - root - INFO - [Allowed] Command in private chat: /voice_motivation
2025-06-17 15:03:24,309 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:03:24,525 - aiogram.event - INFO - Update id=436038075 is handled. Duration 230 ms by bot id=7803467562
2025-06-17 15:03:35,095 - root - INFO - [Allowed] Command in private chat: /stats
2025-06-17 15:03:35,098 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:03:35,178 - aiogram.event - INFO - Update id=436038076 is handled. Duration 83 ms by bot id=7803467562
2025-06-17 15:03:46,689 - root - INFO - [Allowed] Command in private chat: /allow_chat
2025-06-17 15:03:46,700 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:03:46,776 - aiogram.event - INFO - Update id=436038077 is handled. Duration 98 ms by bot id=7803467562
2025-06-17 15:04:40,502 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 15:04:40,504 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 15:04:40,505 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 15:04:46,777 - __main__ - INFO - Starting bot...
2025-06-17 15:04:46,785 - __main__ - INFO - Registering middlewares...
2025-06-17 15:04:46,785 - __main__ - INFO - Registering routers...
2025-06-17 15:04:46,785 - __main__ - INFO - Setting up command menus...
2025-06-17 15:04:47,046 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 15:04:47,047 - sisu_bot.bot.services.command_menu_service - ERROR - Failed to set admin commands menu for admin YakuzaNakamoto: invalid literal for int() with base 10: 'YakuzaNakamoto'
2025-06-17 15:04:47,179 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 15:04:47,271 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 15:04:47,271 - sisu_bot.bot.services.command_menu_service - WARNING - Some command menus were not set successfully
2025-06-17 15:04:47,271 - __main__ - WARNING - Some command menus were not set up successfully
2025-06-17 15:04:47,271 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 15:04:47,271 - aiogram.dispatcher - INFO - Start polling
2025-06-17 15:04:47,343 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 15:05:01,868 - root - INFO - [Allowed] Command in private chat: /start ref446318189
2025-06-17 15:05:01,873 - root - INFO - ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ 6867521567 Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÑ‘Ð½ 446318189, Ð¾Ð¶Ð¸Ð´Ð°ÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ð¸
2025-06-17 15:05:02,190 - aiogram.event - INFO - Update id=436038078 is handled. Duration 332 ms by bot id=7803467562
2025-06-17 15:05:12,002 - root - INFO - [Allowed] Command in private chat: /start ref446318189
2025-06-17 15:05:12,004 - root - INFO - ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ 6867521567 Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÑ‘Ð½ 446318189, Ð¾Ð¶Ð¸Ð´Ð°ÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ð¸
2025-06-17 15:05:12,420 - aiogram.event - INFO - Update id=436038079 is handled. Duration 422 ms by bot id=7803467562
2025-06-17 15:05:20,537 - root - INFO - [Allowed] Command in private chat: /help
2025-06-17 15:05:20,693 - aiogram.event - INFO - Update id=436038080 is handled. Duration 158 ms by bot id=7803467562
2025-06-17 15:06:25,691 - root - INFO - [Allowed] Command in private chat: /start
2025-06-17 15:06:25,868 - aiogram.event - INFO - Update id=436038081 is handled. Duration 186 ms by bot id=7803467562
2025-06-17 15:06:27,523 - root - INFO - [Allowed] Command in private chat: /help
2025-06-17 15:06:27,682 - aiogram.event - INFO - Update id=436038082 is handled. Duration 162 ms by bot id=7803467562
2025-06-17 15:06:29,888 - root - INFO - [Allowed] Command in private chat: /myrank
2025-06-17 15:06:29,988 - aiogram.event - INFO - Update id=436038083 is handled. Duration 104 ms by bot id=7803467562
2025-06-17 15:06:33,112 - root - INFO - [Allowed] Command in private chat: /ref
2025-06-17 15:06:33,114 - root - INFO - !!! REF HANDLER Ð’Ð«Ð—Ð’ÐÐ !!!
2025-06-17 15:06:33,114 - root - INFO - REF HANDLER START: User 6867521567
2025-06-17 15:06:33,117 - root - INFO - REF: Loading users data for 6867521567
2025-06-17 15:06:33,166 - root - INFO - REF: Generated ref link for 6867521567: https://t.me/SisuDatuBot?start=ref6867521567
2025-06-17 15:06:33,166 - root - INFO - REF: Sending response to 6867521567
2025-06-17 15:06:33,246 - root - INFO - REF: Successfully sent ref link to 6867521567
2025-06-17 15:06:33,246 - aiogram.event - INFO - Update id=436038084 is handled. Duration 137 ms by bot id=7803467562
2025-06-17 15:14:08,613 - root - INFO - [Allowed] Command in private chat: /ref
2025-06-17 15:14:08,617 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:14:08,617 - root - INFO - !!! REF HANDLER Ð’Ð«Ð—Ð’ÐÐ !!!
2025-06-17 15:14:08,617 - root - INFO - REF HANDLER START: User 446318189
2025-06-17 15:14:08,617 - root - INFO - REF: Loading users data for 446318189
2025-06-17 15:14:08,765 - root - INFO - REF: Generated ref link for 446318189: https://t.me/SisuDatuBot?start=ref446318189
2025-06-17 15:14:08,766 - root - INFO - REF: Sending response to 446318189
2025-06-17 15:14:08,837 - root - INFO - REF: Successfully sent ref link to 446318189
2025-06-17 15:14:08,838 - aiogram.event - INFO - Update id=436038085 is handled. Duration 228 ms by bot id=7803467562
2025-06-17 15:14:28,698 - root - INFO - [Allowed] Command in private chat: /start ref446318189
2025-06-17 15:14:28,709 - root - INFO - ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ 6045718255 Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÑ‘Ð½ 446318189, Ð¾Ð¶Ð¸Ð´Ð°ÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ð¸
2025-06-17 15:14:28,972 - aiogram.event - INFO - Update id=436038086 is handled. Duration 282 ms by bot id=7803467562
2025-06-17 15:17:11,452 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 15:17:11,455 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 15:17:11,455 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 15:17:18,250 - __main__ - INFO - Starting bot...
2025-06-17 15:17:18,259 - __main__ - INFO - Registering middlewares...
2025-06-17 15:17:18,259 - __main__ - INFO - Registering routers...
2025-06-17 15:17:18,259 - __main__ - INFO - Setting up command menus...
2025-06-17 15:17:18,551 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 15:17:18,553 - sisu_bot.bot.services.command_menu_service - ERROR - Failed to set admin commands menu for admin YakuzaNakamoto: invalid literal for int() with base 10: 'YakuzaNakamoto'
2025-06-17 15:17:18,681 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 15:17:19,237 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 15:17:19,239 - sisu_bot.bot.services.command_menu_service - WARNING - Some command menus were not set successfully
2025-06-17 15:17:19,243 - __main__ - WARNING - Some command menus were not set up successfully
2025-06-17 15:17:19,244 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 15:17:19,244 - aiogram.dispatcher - INFO - Start polling
2025-06-17 15:17:19,291 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 15:17:23,552 - root - INFO - [Allowed] Command in private chat: /list_admins
2025-06-17 15:17:23,585 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:17:23,974 - aiogram.event - INFO - Update id=436038087 is handled. Duration 423 ms by bot id=7803467562
2025-06-17 15:17:40,574 - root - INFO - [Allowed] Command in private chat: /adminlog
2025-06-17 15:17:40,577 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:17:40,894 - aiogram.event - INFO - Update id=436038088 is handled. Duration 320 ms by bot id=7803467562
2025-06-17 15:18:30,453 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 15:18:30,458 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 15:18:30,459 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 15:19:06,397 - __main__ - INFO - Starting bot...
2025-06-17 15:19:06,408 - __main__ - INFO - Registering middlewares...
2025-06-17 15:19:06,408 - __main__ - INFO - Registering routers...
2025-06-17 15:19:06,408 - __main__ - INFO - Setting up command menus...
2025-06-17 15:19:06,608 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 15:19:06,608 - sisu_bot.bot.services.command_menu_service - ERROR - Failed to set admin commands menu for admin YakuzaNakamoto: invalid literal for int() with base 10: 'YakuzaNakamoto'
2025-06-17 15:19:06,680 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 15:19:06,740 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 15:19:06,740 - sisu_bot.bot.services.command_menu_service - WARNING - Some command menus were not set successfully
2025-06-17 15:19:06,740 - __main__ - WARNING - Some command menus were not set up successfully
2025-06-17 15:19:06,741 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 15:19:06,743 - aiogram.dispatcher - INFO - Start polling
2025-06-17 15:19:06,796 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 15:19:13,225 - root - INFO - [Allowed] Command in private chat: /start ref446318189
2025-06-17 15:19:13,726 - aiogram.event - INFO - Update id=436038089 is handled. Duration 509 ms by bot id=7803467562
2025-06-17 15:19:26,686 - aiogram.event - INFO - Update id=436038090 is handled. Duration 113 ms by bot id=7803467562
2025-06-17 15:20:26,534 - root - INFO - [Allowed] Command in private chat: /help
2025-06-17 15:20:26,739 - aiogram.event - INFO - Update id=436038091 is handled. Duration 215 ms by bot id=7803467562
2025-06-17 15:20:31,383 - root - INFO - [Allowed] Command in private chat: /top
2025-06-17 15:20:31,461 - aiogram.event - INFO - Update id=436038092 is handled. Duration 79 ms by bot id=7803467562
2025-06-17 15:20:40,834 - root - INFO - [Allowed] Command in private chat: /myrank
2025-06-17 15:20:41,025 - aiogram.event - INFO - Update id=436038093 is handled. Duration 220 ms by bot id=7803467562
2025-06-17 15:20:47,569 - root - INFO - [Allowed] Command in private chat: /myrank
2025-06-17 15:20:47,732 - aiogram.event - INFO - Update id=436038094 is handled. Duration 164 ms by bot id=7803467562
2025-06-17 15:22:26,574 - root - INFO - [Allowed] Command in private chat: /admin
2025-06-17 15:22:26,733 - aiogram.event - INFO - Update id=436038095 is handled. Duration 178 ms by bot id=7803467562
2025-06-17 15:22:56,335 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 15:22:56,354 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 15:22:56,356 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 15:22:59,780 - __main__ - INFO - Starting bot...
2025-06-17 15:22:59,788 - __main__ - INFO - Registering middlewares...
2025-06-17 15:22:59,788 - __main__ - INFO - Registering routers...
2025-06-17 15:22:59,788 - __main__ - INFO - Setting up command menus...
2025-06-17 15:23:00,026 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 15:23:00,029 - sisu_bot.bot.services.command_menu_service - ERROR - Failed to set admin commands menu for admin YakuzaNakamoto: invalid literal for int() with base 10: 'YakuzaNakamoto'
2025-06-17 15:23:00,085 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 15:23:00,145 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 15:23:00,145 - sisu_bot.bot.services.command_menu_service - WARNING - Some command menus were not set successfully
2025-06-17 15:23:00,145 - __main__ - WARNING - Some command menus were not set up successfully
2025-06-17 15:23:00,145 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 15:23:00,146 - aiogram.dispatcher - INFO - Start polling
2025-06-17 15:23:00,193 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 15:23:05,206 - root - INFO - [Allowed] Command in private chat: /admin
2025-06-17 15:23:05,393 - aiogram.event - INFO - Update id=436038096 is handled. Duration 208 ms by bot id=7803467562
2025-06-17 15:23:18,423 - root - INFO - [Allowed] Command in private chat: /help
2025-06-17 15:23:18,584 - aiogram.event - INFO - Update id=436038097 is handled. Duration 165 ms by bot id=7803467562
2025-06-17 15:25:02,836 - root - INFO - [Allowed] Command in private chat: /addadmin
2025-06-17 15:25:03,422 - aiogram.event - INFO - Update id=436038098 is handled. Duration 592 ms by bot id=7803467562
2025-06-17 15:28:44,381 - root - INFO - [Allowed] Command in private chat: /addadmin #6485553352
2025-06-17 15:28:44,391 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:28:44,557 - aiogram.event - INFO - Update id=436038099 is handled. Duration 178 ms by bot id=7803467562
2025-06-17 15:28:50,843 - root - INFO - [Allowed] Command in private chat: /list_admins
2025-06-17 15:28:50,844 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:28:50,966 - aiogram.event - INFO - Update id=436038100 is handled. Duration 140 ms by bot id=7803467562
2025-06-17 15:29:16,305 - root - INFO - [Allowed] Command in private chat: /addadmin
2025-06-17 15:29:16,624 - aiogram.event - INFO - Update id=436038101 is handled. Duration 324 ms by bot id=7803467562
2025-06-17 15:29:20,472 - root - INFO - [Allowed] Command in private chat: /start
2025-06-17 15:29:20,652 - aiogram.event - INFO - Update id=436038102 is handled. Duration 184 ms by bot id=7803467562
2025-06-17 15:29:24,774 - aiogram.event - INFO - Update id=436038103 is handled. Duration 168 ms by bot id=7803467562
2025-06-17 15:29:30,187 - root - INFO - [Allowed] Command in private chat: /myrank
2025-06-17 15:29:30,389 - aiogram.event - INFO - Update id=436038104 is handled. Duration 203 ms by bot id=7803467562
2025-06-17 15:31:16,012 - root - INFO - [Allowed] Command in private chat: /removeadmin
2025-06-17 15:31:16,026 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:31:16,204 - aiogram.event - INFO - Update id=436038105 is handled. Duration 194 ms by bot id=7803467562
2025-06-17 15:31:34,741 - root - INFO - [Allowed] Command in private chat: /removeadmin YakuzaNakamoto
#6485553352
2025-06-17 15:31:34,752 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:31:34,960 - aiogram.event - INFO - Update id=436038106 is handled. Duration 220 ms by bot id=7803467562
2025-06-17 15:31:45,350 - root - INFO - [Allowed] Command in private chat: /addadmin #6485553352
2025-06-17 15:31:45,352 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:31:45,426 - aiogram.event - INFO - Update id=436038107 is handled. Duration 77 ms by bot id=7803467562
2025-06-17 15:31:47,499 - root - INFO - [Allowed] Command in private chat: /list_admins
2025-06-17 15:31:47,501 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:31:47,599 - aiogram.event - INFO - Update id=436038108 is handled. Duration 102 ms by bot id=7803467562
2025-06-17 15:33:04,169 - root - INFO - [Allowed] Command in private chat: /removeadmin 6485553352
2025-06-17 15:33:04,173 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:33:04,396 - aiogram.event - INFO - Update id=436038109 is handled. Duration 228 ms by bot id=7803467562
2025-06-17 15:33:07,302 - root - INFO - [Allowed] Command in private chat: /list_admins
2025-06-17 15:33:07,303 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:33:07,385 - aiogram.event - INFO - Update id=436038110 is handled. Duration 84 ms by bot id=7803467562
2025-06-17 15:33:19,571 - root - INFO - [Allowed] Command in private chat: /myrank
2025-06-17 15:33:19,652 - aiogram.event - INFO - Update id=436038111 is handled. Duration 100 ms by bot id=7803467562
2025-06-17 15:33:21,565 - root - INFO - [Allowed] Command in private chat: /addadmin
2025-06-17 15:33:21,872 - aiogram.event - INFO - Update id=436038112 is handled. Duration 309 ms by bot id=7803467562
2025-06-17 15:33:38,824 - root - INFO - [Allowed] Command in private chat: /admin
2025-06-17 15:33:38,997 - aiogram.event - INFO - Update id=436038113 is handled. Duration 180 ms by bot id=7803467562
2025-06-17 15:34:09,933 - root - INFO - [Allowed] Command in private chat: /addadmin
2025-06-17 15:34:09,941 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:34:10,187 - aiogram.event - INFO - Update id=436038114 is handled. Duration 255 ms by bot id=7803467562
2025-06-17 15:40:02,136 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 15:40:02,139 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 15:40:02,139 - aiogram.dispatcher - INFO - Polling stopped
2025-06-17 15:45:13,182 - __main__ - INFO - Starting bot...
2025-06-17 15:45:13,190 - __main__ - INFO - Registering middlewares...
2025-06-17 15:45:13,190 - __main__ - INFO - Registering routers...
2025-06-17 15:45:13,190 - __main__ - INFO - Setting up command menus...
2025-06-17 15:45:13,411 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 15:45:13,412 - sisu_bot.bot.services.command_menu_service - ERROR - Failed to set admin commands menu for admin #6485553352: invalid literal for int() with base 10: '#6485553352'
2025-06-17 15:45:13,482 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 15:45:13,579 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 15:45:13,579 - sisu_bot.bot.services.command_menu_service - WARNING - Some command menus were not set successfully
2025-06-17 15:45:13,579 - __main__ - WARNING - Some command menus were not set up successfully
2025-06-17 15:45:13,579 - __main__ - INFO - Bot started successfully! ðŸš€
2025-06-17 15:45:13,579 - aiogram.dispatcher - INFO - Start polling
2025-06-17 15:45:13,690 - aiogram.dispatcher - INFO - Run polling for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 15:45:13,979 - root - INFO - [Allowed] Command in private chat: /admin_help
2025-06-17 15:45:14,146 - aiogram.event - INFO - Update id=436038115 is handled. Duration 176 ms by bot id=7803467562
2025-06-17 15:45:21,650 - root - INFO - [Allowed] Command in private chat: /admin_help
2025-06-17 15:45:21,830 - aiogram.event - INFO - Update id=436038116 is handled. Duration 184 ms by bot id=7803467562
2025-06-17 15:46:15,324 - root - INFO - [Allowed] Command in private chat: /addadmin #6485553352
2025-06-17 15:46:15,341 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:46:15,528 - aiogram.event - INFO - Update id=436038117 is handled. Duration 206 ms by bot id=7803467562
2025-06-17 15:46:23,923 - root - INFO - [Allowed] Command in private chat: /addadmin 6485553352
2025-06-17 15:46:23,925 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:46:23,988 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set default commands menu
2025-06-17 15:46:24,079 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set admin commands menu for admin 6485553352
2025-06-17 15:46:24,141 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 446318189
2025-06-17 15:46:24,196 - sisu_bot.bot.services.command_menu_service - INFO - Successfully set superadmin commands menu for superadmin 5857816562
2025-06-17 15:46:24,197 - sisu_bot.bot.services.command_menu_service - INFO - All command menus were set successfully
2025-06-17 15:46:24,271 - aiogram.event - INFO - Update id=436038118 is handled. Duration 348 ms by bot id=7803467562
2025-06-17 15:46:27,214 - root - INFO - [Allowed] Command in private chat: /list_admins
2025-06-17 15:46:27,216 - sisu_bot.bot.middlewares.rate_limit - INFO - RateLimitMiddleware: Bypassing rate limit for admin user 446318189
2025-06-17 15:46:27,341 - aiogram.event - INFO - Update id=436038119 is handled. Duration 128 ms by bot id=7803467562
2025-06-17 15:46:34,048 - root - INFO - [Allowed] Command in private chat: /admin_help
2025-06-17 15:46:34,233 - aiogram.event - INFO - Update id=436038120 is handled. Duration 187 ms by bot id=7803467562
2025-06-17 15:46:58,971 - root - INFO - [Allowed] Command in private chat: /admin
2025-06-17 15:46:59,166 - aiogram.event - INFO - Update id=436038121 is handled. Duration 207 ms by bot id=7803467562
2025-06-17 15:47:10,503 - root - INFO - [Allowed] Command in private chat: /trigger_stats
2025-06-17 15:47:10,572 - aiogram.event - INFO - Update id=436038122 is handled. Duration 74 ms by bot id=7803467562
2025-06-17 15:51:10,987 - aiogram.dispatcher - WARNING - Received SIGINT signal
2025-06-17 15:51:10,991 - aiogram.dispatcher - INFO - Polling stopped for bot @SisuDatuBot id=7803467562 - 'Sisu'
2025-06-17 15:51:10,991 - aiogram.dispatcher - INFO - Polling stopped
