#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

echo "üîç –ê–ù–ê–õ–ò–ó –ü–†–û–ï–ö–¢–ê SISUDATUBOT"
echo "================================"

# Git —Å—Ç–∞—Ç—É—Å
echo -e "\nüìã GIT –°–¢–ê–¢–£–°:"
git status --short

echo -e "\nüìã –ü–û–°–õ–ï–î–ù–ò–ï –ö–û–ú–ú–ò–¢–´:"
git log --oneline -5

# –õ–æ–≥–∏
echo -e "\nüìã –õ–û–ì–ò:"
if [ -d "logs" ]; then
    echo "–ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ª–æ–≥–æ–≤:"
    ls -la logs/*.log 2>/dev/null || echo "–§–∞–π–ª—ã –ª–æ–≥–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
    
    echo -e "\nüìã –ü–û–°–õ–ï–î–ù–ò–ï –û–®–ò–ë–ö–ò (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å—Ç—Ä–æ–∫):"
    for log in logs/*.log; do
        if [ -f "$log" ]; then
            echo "=== $log ==="
            grep -i "error\|exception\|traceback" "$log" | tail -10
        fi
    done
else
    echo "–ü–∞–ø–∫–∞ logs –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
fi

# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
echo -e "\nüìÅ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê:"
echo "–û—Å–Ω–æ–≤–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:"
ls -la | grep "^d"

echo -e "\nüìÅ SISU_BOT –°–¢–†–£–ö–¢–£–†–ê:"
if [ -d "sisu_bot" ]; then
    find sisu_bot -type d -maxdepth 2 | head -20
else
    echo "–ü–∞–ø–∫–∞ sisu_bot –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
fi

# Python —Ñ–∞–π–ª—ã
echo -e "\nüêç PYTHON –§–ê–ô–õ–´ (–ø–µ—Ä–≤—ã–µ 20):"
find . -name "*.py" -not -path "./venv/*" -not -path "./__pycache__/*" | head -20

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
echo -e "\n‚öôÔ∏è –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–û–ù–ù–´–ï –§–ê–ô–õ–´:"
ls -la *.txt *.toml *.yml *.yaml *.json 2>/dev/null || echo "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

# –ó–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
echo -e "\nüîÑ –ó–ê–ü–£–©–ï–ù–ù–´–ï –ü–†–û–¶–ï–°–°–´:"
ps aux | grep -i "python\|sisu" | grep -v grep || echo "–ü—Ä–æ—Ü–µ—Å—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
echo -e "\nüíæ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –î–ò–°–ö–ê:"
du -sh . 2>/dev/null || echo "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–∏—Å–∫–µ"

echo -e "\n‚úÖ –ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù" 